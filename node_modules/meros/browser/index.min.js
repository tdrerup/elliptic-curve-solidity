!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).meros={})}(this,(function(e){const t="\r\n\r\n",n=new TextDecoder;e.meros=async function(e,i){if(!e.ok||!e.body||e.bodyUsed)return e;const o=e.headers.get("content-type");if(!o||!~o.indexOf("multipart/mixed"))return e;const s=o.indexOf("boundary=");return async function*(e,i,o){const s=e.getReader(),r=!o||!o.multiple;let d="",f=!0,l=[];try{let e;e:for(;!(e=await s.read()).done;){const o=n.decode(e.value),s=o.indexOf(i);let c=d.length;for(d+=o,~s?c+=s:c=d.indexOf(i),l=[];~c;){const e=d.substring(0,c),n=d.substring(c+i.length);if(f)f=!1;else{const i={},o=e.indexOf(t),s=d.slice(0,o).toString().trim().split(/\r\n/);let f;for(;f=s.shift();)f=f.split(": "),i[f.shift().toLowerCase()]=f.join(": ");let c=e.substring(o+t.length,e.lastIndexOf("\r\n")),a=!1;if(f=i["content-type"],f&&~f.indexOf("application/json"))try{c=JSON.parse(c),a=!0}catch(e){}if(f={headers:i,body:c,json:a},r?yield f:l.push(f),"--"===n.substring(0,2))break e}d=n,c=d.indexOf(i)}l.length&&(yield l)}}finally{l.length&&(yield l),s.releaseLock()}}(e.body,`--${~s?o.substring(s+9).trim().replace(/['"]/g,""):"-"}`,i)}}));
