{"version":3,"sources":["../src/webusb.js"],"names":["ledgerDevices","vendorId","ledgerUSBVendorId","requestLedgerDevice","device","navigator","usb","requestDevice","filters","getLedgerDevices","devices","getDevices","filter","d","getFirstLedgerDevice","existingDevices","length","isSupported","Promise","resolve"],"mappings":";;;;;;;;;;AACA;;AAEA,MAAMA,aAAa,GAAG,CAAC;AAAEC,EAAAA,QAAQ,EAAEC;AAAZ,CAAD,CAAtB;;AAEO,eAAeC,mBAAf,GAAyD;AAC9D;AACA,QAAMC,MAAM,GAAG,MAAMC,SAAS,CAACC,GAAV,CAAcC,aAAd,CAA4B;AAAEC,IAAAA,OAAO,EAAER;AAAX,GAA5B,CAArB;AACA,SAAOI,MAAP;AACD;;AAEM,eAAeK,gBAAf,GAAwD;AAC7D;AACA,QAAMC,OAAO,GAAG,MAAML,SAAS,CAACC,GAAV,CAAcK,UAAd,EAAtB;AACA,SAAOD,OAAO,CAACE,MAAR,CAAgBC,CAAD,IAAOA,CAAC,CAACZ,QAAF,KAAeC,0BAArC,CAAP;AACD;;AAEM,eAAeY,oBAAf,GAA0D;AAC/D,QAAMC,eAAe,GAAG,MAAMN,gBAAgB,EAA9C;AACA,MAAIM,eAAe,CAACC,MAAhB,GAAyB,CAA7B,EAAgC,OAAOD,eAAe,CAAC,CAAD,CAAtB;AAChC,SAAOZ,mBAAmB,EAA1B;AACD;;AAEM,MAAMc,WAAW,GAAG,MACzBC,OAAO,CAACC,OAAR,CACE,CAAC,CAACd,SAAF,IACE;AACA,CAAC,CAACA,SAAS,CAACC,GAFd,IAGE,OAAOD,SAAS,CAACC,GAAV,CAAcK,UAArB,KAAoC,UAJxC,CADK","sourcesContent":["// @flow\nimport { ledgerUSBVendorId } from \"@ledgerhq/devices\";\n\nconst ledgerDevices = [{ vendorId: ledgerUSBVendorId }];\n\nexport async function requestLedgerDevice(): Promise<USBDevice> {\n  // $FlowFixMe\n  const device = await navigator.usb.requestDevice({ filters: ledgerDevices });\n  return device;\n}\n\nexport async function getLedgerDevices(): Promise<USBDevice[]> {\n  // $FlowFixMe\n  const devices = await navigator.usb.getDevices();\n  return devices.filter((d) => d.vendorId === ledgerUSBVendorId);\n}\n\nexport async function getFirstLedgerDevice(): Promise<USBDevice> {\n  const existingDevices = await getLedgerDevices();\n  if (existingDevices.length > 0) return existingDevices[0];\n  return requestLedgerDevice();\n}\n\nexport const isSupported = (): Promise<boolean> =>\n  Promise.resolve(\n    !!navigator &&\n      // $FlowFixMe\n      !!navigator.usb &&\n      typeof navigator.usb.getDevices === \"function\"\n  );\n"],"file":"webusb.js"}