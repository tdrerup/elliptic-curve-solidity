"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hostUserInfo = exports.domain = exports.filterInvalidSubdomainLabel = void 0;
const array_1 = require("../../arbitrary/array");
const SpecificCharacterRange_1 = require("./helpers/SpecificCharacterRange");
const option_1 = require("../../arbitrary/option");
const stringOf_1 = require("../../arbitrary/stringOf");
const tuple_1 = require("../../arbitrary/tuple");
function filterInvalidSubdomainLabel(subdomainLabel) {
    if (subdomainLabel.length > 63) {
        return false;
    }
    return (subdomainLabel.length < 4 ||
        subdomainLabel[0] !== 'x' ||
        subdomainLabel[1] !== 'n' ||
        subdomainLabel[2] !== '-' ||
        subdomainLabel[3] !== '-');
}
exports.filterInvalidSubdomainLabel = filterInvalidSubdomainLabel;
function subdomainLabel() {
    const alphaNumericArb = SpecificCharacterRange_1.buildLowerAlphaNumericArb([]);
    const alphaNumericHyphenArb = SpecificCharacterRange_1.buildLowerAlphaNumericArb(['-']);
    return tuple_1.tuple(alphaNumericArb, option_1.option(tuple_1.tuple(stringOf_1.stringOf(alphaNumericHyphenArb, { maxLength: 61 }), alphaNumericArb)))
        .map(([f, d]) => (d === null ? f : `${f}${d[0]}${d[1]}`))
        .filter(filterInvalidSubdomainLabel);
}
function domain() {
    const alphaNumericArb = SpecificCharacterRange_1.buildLowerAlphaArb([]);
    const publicSuffixArb = stringOf_1.stringOf(alphaNumericArb, { minLength: 2, maxLength: 10 });
    return (tuple_1.tuple(array_1.array(subdomainLabel(), { minLength: 1, maxLength: 5 }), publicSuffixArb)
        .map(([mid, ext]) => `${mid.join('.')}.${ext}`)
        .filter((d) => d.length <= 255));
}
exports.domain = domain;
function hostUserInfo() {
    const others = ['-', '.', '_', '~', '!', '$', '&', "'", '(', ')', '*', '+', ',', ';', '=', ':'];
    return stringOf_1.stringOf(SpecificCharacterRange_1.buildAlphaNumericPercentArb(others));
}
exports.hostUserInfo = hostUserInfo;
