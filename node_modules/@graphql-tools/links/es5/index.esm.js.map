{"version":3,"file":"index.esm.js","sources":["../../../dist-es5/links/src/AwaitVariablesLink.js","../../../dist-es5/links/src/createServerHttpLink.js","../../../dist-es5/links/src/linkToExecutor.js","../../../dist-es5/links/src/linkToSubscriber.js","../../../dist-es5/links/src/GraphQLUpload.js"],"sourcesContent":["import { __extends } from \"tslib\";\nimport { ApolloLink, Observable } from 'apollo-link';\nfunction getFinalPromise(object) {\n    return Promise.resolve(object).then(function (resolvedObject) {\n        if (resolvedObject == null) {\n            return resolvedObject;\n        }\n        if (Array.isArray(resolvedObject)) {\n            return Promise.all(resolvedObject.map(function (o) { return getFinalPromise(o); }));\n        }\n        else if (typeof resolvedObject === 'object') {\n            var keys_1 = Object.keys(resolvedObject);\n            return Promise.all(keys_1.map(function (key) { return getFinalPromise(resolvedObject[key]); })).then(function (awaitedValues) {\n                for (var i = 0; i < keys_1.length; i++) {\n                    resolvedObject[keys_1[i]] = awaitedValues[i];\n                }\n                return resolvedObject;\n            });\n        }\n        return resolvedObject;\n    });\n}\nvar AwaitVariablesLink = /** @class */ (function (_super) {\n    __extends(AwaitVariablesLink, _super);\n    function AwaitVariablesLink() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AwaitVariablesLink.prototype.request = function (operation, forward) {\n        return new Observable(function (observer) {\n            var subscription;\n            getFinalPromise(operation.variables)\n                .then(function (resolvedVariables) {\n                operation.variables = resolvedVariables;\n                subscription = forward(operation).subscribe({\n                    next: observer.next.bind(observer),\n                    error: observer.error.bind(observer),\n                    complete: observer.complete.bind(observer),\n                });\n            })\n                .catch(observer.error.bind(observer));\n            return function () {\n                if (subscription != null) {\n                    subscription.unsubscribe();\n                }\n            };\n        });\n    };\n    return AwaitVariablesLink;\n}(ApolloLink));\nexport { AwaitVariablesLink };\n//# sourceMappingURL=AwaitVariablesLink.js.map","import { __assign, __extends } from \"tslib\";\nimport { concat } from 'apollo-link';\nimport { createUploadLink, formDataAppendFile, isExtractableFile } from 'apollo-upload-client';\nimport FormData from 'form-data';\nimport { fetch } from 'cross-fetch';\nimport { AwaitVariablesLink } from './AwaitVariablesLink';\nvar FormDataWithStreamSupport = /** @class */ (function (_super) {\n    __extends(FormDataWithStreamSupport, _super);\n    function FormDataWithStreamSupport(options) {\n        var _this = _super.call(this, options) || this;\n        _this.hasUnknowableLength = false;\n        return _this;\n    }\n    FormDataWithStreamSupport.prototype.append = function (key, value, optionsOrFilename) {\n        if (optionsOrFilename === void 0) { optionsOrFilename = {}; }\n        // allow filename as single option\n        var options = typeof optionsOrFilename === 'string' ? { filename: optionsOrFilename } : optionsOrFilename;\n        // empty or either doesn't have path or not an http response\n        if (!options.knownLength &&\n            !Buffer.isBuffer(value) &&\n            typeof value !== 'string' &&\n            !value.path &&\n            !(value.readable && 'httpVersion' in value)) {\n            this.hasUnknowableLength = true;\n        }\n        _super.prototype.append.call(this, key, value, options);\n    };\n    FormDataWithStreamSupport.prototype.getLength = function (callback) {\n        if (this.hasUnknowableLength) {\n            return null;\n        }\n        return _super.prototype.getLength.call(this, callback);\n    };\n    FormDataWithStreamSupport.prototype.getLengthSync = function () {\n        if (this.hasUnknowableLength) {\n            return null;\n        }\n        // eslint-disable-next-line no-sync\n        return _super.prototype.getLengthSync.call(this);\n    };\n    return FormDataWithStreamSupport;\n}(FormData));\nexport var createServerHttpLink = function (options) {\n    return concat(new AwaitVariablesLink(), createUploadLink(__assign(__assign({}, options), { fetch: fetch, FormData: FormDataWithStreamSupport, isExtractableFile: function (value) { return isExtractableFile(value) || (value === null || value === void 0 ? void 0 : value.createReadStream); }, formDataAppendFile: function (form, index, file) {\n            if (file.createReadStream != null) {\n                form.append(index, file.createReadStream(), {\n                    filename: file.filename,\n                    contentType: file.mimetype,\n                });\n            }\n            else {\n                formDataAppendFile(form, index, file);\n            }\n        } })));\n};\n//# sourceMappingURL=createServerHttpLink.js.map","import { toPromise, execute } from 'apollo-link';\nexport var linkToExecutor = function (link) { return function (_a) {\n    var document = _a.document, variables = _a.variables, context = _a.context, info = _a.info;\n    return toPromise(execute(link, {\n        query: document,\n        variables: variables,\n        context: {\n            graphqlContext: context,\n            graphqlResolveInfo: info,\n            clientAwareness: {},\n        },\n    }));\n}; };\n//# sourceMappingURL=linkToExecutor.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { execute } from 'apollo-link';\nimport { observableToAsyncIterable } from '@graphql-tools/utils';\nexport var linkToSubscriber = function (link) { return function (_a) {\n    var document = _a.document, variables = _a.variables, context = _a.context, info = _a.info;\n    return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_b) {\n            return [2 /*return*/, observableToAsyncIterable(execute(link, {\n                    query: document,\n                    variables: variables,\n                    context: {\n                        graphqlContext: context,\n                        graphqlResolveInfo: info,\n                        clientAwareness: {},\n                    },\n                }))];\n        });\n    });\n}; };\n//# sourceMappingURL=linkToSubscriber.js.map","import { GraphQLScalarType, GraphQLError } from 'graphql';\nimport isPromise from 'is-promise';\nvar GraphQLUpload = new GraphQLScalarType({\n    name: 'Upload',\n    description: 'The `Upload` scalar type represents a file upload.',\n    parseValue: function (value) {\n        if (value != null && isPromise(value.promise)) {\n            // graphql-upload v10\n            return value.promise;\n        }\n        else if (isPromise(value)) {\n            // graphql-upload v9\n            return value;\n        }\n        throw new GraphQLError('Upload value invalid.');\n    },\n    // serialization requires to support schema stitching\n    serialize: function (value) { return value; },\n    parseLiteral: function (ast) {\n        throw new GraphQLError('Upload literal unsupported.', ast);\n    },\n});\nexport { GraphQLUpload };\n//# sourceMappingURL=GraphQLUpload.js.map"],"names":[],"mappings":"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"}