{"version":3,"file":"index.cjs.js","sources":["../../../dist-es5/loaders/graphql-file/src/index.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { isValidPath, parseGraphQLSDL, } from '@graphql-tools/utils';\nimport { isAbsolute, resolve } from 'path';\nimport { readFileSync, accessSync, promises as fsPromises } from 'fs';\nimport { cwd as processCwd } from 'process';\nimport { processImport } from '@graphql-tools/import';\nvar readFile = fsPromises.readFile, access = fsPromises.access;\nvar FILE_EXTENSIONS = ['.gql', '.gqls', '.graphql', '.graphqls'];\nfunction isGraphQLImportFile(rawSDL) {\n    var trimmedRawSDL = rawSDL.trim();\n    return trimmedRawSDL.startsWith('# import') || trimmedRawSDL.startsWith('#import');\n}\n/**\n * This loader loads documents and type definitions from `.graphql` files.\n *\n * You can load a single source:\n *\n * ```js\n * const schema = await loadSchema('schema.graphql', {\n *   loaders: [\n *     new GraphQLFileLoader()\n *   ]\n * });\n * ```\n *\n * Or provide a glob pattern to load multiple sources:\n *\n * ```js\n * const schema = await loadSchema('graphql/*.graphql', {\n *   loaders: [\n *     new GraphQLFileLoader()\n *   ]\n * });\n * ```\n */\nvar GraphQLFileLoader = /** @class */ (function () {\n    function GraphQLFileLoader() {\n    }\n    GraphQLFileLoader.prototype.loaderId = function () {\n        return 'graphql-file';\n    };\n    GraphQLFileLoader.prototype.canLoad = function (pointer, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var normalizedFilePath, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!isValidPath(pointer)) return [3 /*break*/, 4];\n                        if (!FILE_EXTENSIONS.find(function (extension) { return pointer.endsWith(extension); })) return [3 /*break*/, 4];\n                        normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, access(normalizedFilePath)];\n                    case 2:\n                        _b.sent();\n                        return [2 /*return*/, true];\n                    case 3:\n                        _a = _b.sent();\n                        return [2 /*return*/, false];\n                    case 4: return [2 /*return*/, false];\n                }\n            });\n        });\n    };\n    GraphQLFileLoader.prototype.canLoadSync = function (pointer, options) {\n        if (isValidPath(pointer)) {\n            if (FILE_EXTENSIONS.find(function (extension) { return pointer.endsWith(extension); })) {\n                var normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n                try {\n                    accessSync(normalizedFilePath);\n                    return true;\n                }\n                catch (_a) {\n                    return false;\n                }\n            }\n        }\n        return false;\n    };\n    GraphQLFileLoader.prototype.load = function (pointer, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var normalizedFilePath, rawSDL;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n                        return [4 /*yield*/, readFile(normalizedFilePath, { encoding: 'utf8' })];\n                    case 1:\n                        rawSDL = _a.sent();\n                        return [2 /*return*/, this.handleFileContent(rawSDL, pointer, options)];\n                }\n            });\n        });\n    };\n    GraphQLFileLoader.prototype.loadSync = function (pointer, options) {\n        var normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n        var rawSDL = readFileSync(normalizedFilePath, { encoding: 'utf8' });\n        return this.handleFileContent(rawSDL, pointer, options);\n    };\n    GraphQLFileLoader.prototype.handleFileContent = function (rawSDL, pointer, options) {\n        if (!options.skipGraphQLImport && isGraphQLImportFile(rawSDL)) {\n            var document_1 = processImport(pointer, options.cwd);\n            return {\n                location: pointer,\n                document: document_1,\n            };\n        }\n        return parseGraphQLSDL(pointer, rawSDL, options);\n    };\n    return GraphQLFileLoader;\n}());\nexport { GraphQLFileLoader };\n//# sourceMappingURL=index.js.map"],"names":["fsPromises","__awaiter","__generator","isValidPath","isAbsolute","resolve","processCwd","accessSync","readFileSync","processImport","parseGraphQLSDL"],"mappings":"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"}