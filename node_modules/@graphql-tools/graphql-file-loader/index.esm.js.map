{"version":3,"file":"index.esm.js","sources":["../../../dist/loaders/graphql-file/src/index.js"],"sourcesContent":["import { isValidPath, parseGraphQLSDL, } from '@graphql-tools/utils';\nimport { isAbsolute, resolve } from 'path';\nimport { readFileSync, accessSync, promises as fsPromises } from 'fs';\nimport { cwd as processCwd } from 'process';\nimport { processImport } from '@graphql-tools/import';\nconst { readFile, access } = fsPromises;\nconst FILE_EXTENSIONS = ['.gql', '.gqls', '.graphql', '.graphqls'];\nfunction isGraphQLImportFile(rawSDL) {\n    const trimmedRawSDL = rawSDL.trim();\n    return trimmedRawSDL.startsWith('# import') || trimmedRawSDL.startsWith('#import');\n}\n/**\n * This loader loads documents and type definitions from `.graphql` files.\n *\n * You can load a single source:\n *\n * ```js\n * const schema = await loadSchema('schema.graphql', {\n *   loaders: [\n *     new GraphQLFileLoader()\n *   ]\n * });\n * ```\n *\n * Or provide a glob pattern to load multiple sources:\n *\n * ```js\n * const schema = await loadSchema('graphql/*.graphql', {\n *   loaders: [\n *     new GraphQLFileLoader()\n *   ]\n * });\n * ```\n */\nexport class GraphQLFileLoader {\n    loaderId() {\n        return 'graphql-file';\n    }\n    async canLoad(pointer, options) {\n        if (isValidPath(pointer)) {\n            if (FILE_EXTENSIONS.find(extension => pointer.endsWith(extension))) {\n                const normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n                try {\n                    await access(normalizedFilePath);\n                    return true;\n                }\n                catch (_a) {\n                    return false;\n                }\n            }\n        }\n        return false;\n    }\n    canLoadSync(pointer, options) {\n        if (isValidPath(pointer)) {\n            if (FILE_EXTENSIONS.find(extension => pointer.endsWith(extension))) {\n                const normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n                try {\n                    accessSync(normalizedFilePath);\n                    return true;\n                }\n                catch (_a) {\n                    return false;\n                }\n            }\n        }\n        return false;\n    }\n    async load(pointer, options) {\n        const normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n        const rawSDL = await readFile(normalizedFilePath, { encoding: 'utf8' });\n        return this.handleFileContent(rawSDL, pointer, options);\n    }\n    loadSync(pointer, options) {\n        const normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || processCwd(), pointer);\n        const rawSDL = readFileSync(normalizedFilePath, { encoding: 'utf8' });\n        return this.handleFileContent(rawSDL, pointer, options);\n    }\n    handleFileContent(rawSDL, pointer, options) {\n        if (!options.skipGraphQLImport && isGraphQLImportFile(rawSDL)) {\n            const document = processImport(pointer, options.cwd);\n            return {\n                location: pointer,\n                document,\n            };\n        }\n        return parseGraphQLSDL(pointer, rawSDL, options);\n    }\n}\n//# sourceMappingURL=index.js.map"],"names":["fsPromises","processCwd"],"mappings":"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"}