"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jest_mock_axios_1 = __importDefault(require("jest-mock-axios"));
const src_1 = require("../src");
const api_1 = require("../src/apis/avm/api");
const api_2 = require("../src/apis/admin/api");
const api_3 = require("../src/apis/health/api");
const api_4 = require("../src/apis/info/api");
const api_5 = require("../src/apis/keystore/api");
const api_6 = require("../src/apis/metrics/api");
const api_7 = require("../src/apis/platformvm/api");
const testlib_1 = require("./testlib");
describe("Avalanche", () => {
    const blockchainID = "6h2s5de1VC65meajE1L2PjvZ1MXvHc3F6eqPCGKuDt4MxiweF";
    const host = "127.0.0.1";
    const port = 9650;
    const protocol = "https";
    let avalanche;
    beforeAll(() => {
        avalanche = new src_1.Avalanche(host, port, protocol, 12345, undefined, undefined, undefined, true);
        avalanche.addAPI("admin", api_2.AdminAPI);
        avalanche.addAPI("xchain", api_1.AVMAPI, "/ext/subnet/avm", blockchainID);
        avalanche.addAPI("health", api_3.HealthAPI);
        avalanche.addAPI("info", api_4.InfoAPI);
        avalanche.addAPI("keystore", api_5.KeystoreAPI);
        avalanche.addAPI("metrics", api_6.MetricsAPI);
        avalanche.addAPI("pchain", api_7.PlatformVMAPI);
    });
    test("Can initialize without port", () => {
        const a = new src_1.Avalanche(host, undefined, protocol, 12345);
        expect(a.getPort()).toBe(undefined);
        expect(a.getURL()).toBe(`${protocol}://${host}`);
    });
    test("Can initialize with port", () => {
        expect(avalanche.getIP()).toBe(host);
        expect(avalanche.getHost()).toBe(host);
        expect(avalanche.getPort()).toBe(port);
        expect(avalanche.getProtocol()).toBe(protocol);
        expect(avalanche.getURL()).toBe(`${protocol}://${host}:${port}`);
        expect(avalanche.getNetworkID()).toBe(12345);
        expect(avalanche.getHeaders()).toStrictEqual({});
        avalanche.setNetworkID(50);
        expect(avalanche.getNetworkID()).toBe(50);
        avalanche.setNetworkID(12345);
        expect(avalanche.getNetworkID()).toBe(12345);
    });
    test("Endpoints correct", () => {
        expect(avalanche.Admin()).not.toBeInstanceOf(api_1.AVMAPI);
        expect(avalanche.Admin()).toBeInstanceOf(api_2.AdminAPI);
        expect(avalanche.XChain()).not.toBeInstanceOf(api_2.AdminAPI);
        expect(avalanche.XChain()).toBeInstanceOf(api_1.AVMAPI);
        expect(avalanche.Health()).not.toBeInstanceOf(api_5.KeystoreAPI);
        expect(avalanche.Health()).toBeInstanceOf(api_3.HealthAPI);
        expect(avalanche.Info()).not.toBeInstanceOf(api_5.KeystoreAPI);
        expect(avalanche.Info()).toBeInstanceOf(api_4.InfoAPI);
        expect(avalanche.PChain()).not.toBeInstanceOf(api_5.KeystoreAPI);
        expect(avalanche.PChain()).toBeInstanceOf(api_7.PlatformVMAPI);
        expect(avalanche.NodeKeys()).not.toBeInstanceOf(api_7.PlatformVMAPI);
        expect(avalanche.NodeKeys()).toBeInstanceOf(api_5.KeystoreAPI);
        expect(avalanche.Metrics()).not.toBeInstanceOf(api_5.KeystoreAPI);
        expect(avalanche.Metrics()).toBeInstanceOf(api_6.MetricsAPI);
        expect(avalanche.Admin().getRPCID()).toBe(1);
        expect(avalanche.XChain().getRPCID()).toBe(1);
        expect(avalanche.PChain().getRPCID()).toBe(1);
        expect(avalanche.NodeKeys().getRPCID()).toBe(1);
    });
    test("Create new API", () => {
        avalanche.addAPI("avm2", api_1.AVMAPI);
        expect(avalanche.api("avm2")).toBeInstanceOf(api_1.AVMAPI);
        avalanche.addAPI("keystore2", api_5.KeystoreAPI, "/ext/keystore2");
        expect(avalanche.api("keystore2")).toBeInstanceOf(api_5.KeystoreAPI);
        avalanche.api("keystore2").setBaseURL("/ext/keystore3");
        expect(avalanche.api("keystore2").getBaseURL()).toBe("/ext/keystore3");
        expect(avalanche.api("keystore2").getDB()).toHaveProperty("namespace");
    });
    test("Customize headers", () => {
        avalanche.setHeader("X-Custom-Header", "example");
        avalanche.setHeader("X-Foo", "Foo");
        avalanche.setHeader("X-Bar", "Bar");
        expect(avalanche.getHeaders()).toStrictEqual({
            "X-Custom-Header": "example",
            "X-Foo": "Foo",
            "X-Bar": "Bar"
        });
        avalanche.removeHeader("X-Foo");
        expect(avalanche.getHeaders()).toStrictEqual({
            "X-Custom-Header": "example",
            "X-Bar": "Bar"
        });
        avalanche.removeAllHeaders();
        expect(avalanche.getHeaders()).toStrictEqual({});
    });
    test("Customize request config", () => {
        expect(avalanche.getRequestConfig()).toStrictEqual({});
        avalanche.setRequestConfig("withCredentials", true);
        avalanche.setRequestConfig("withFoo", "Foo");
        avalanche.setRequestConfig("withBar", "Bar");
        expect(avalanche.getRequestConfig()).toStrictEqual({
            withCredentials: true,
            withFoo: "Foo",
            withBar: "Bar"
        });
        avalanche.removeRequestConfig("withFoo");
        expect(avalanche.getRequestConfig()).toStrictEqual({
            withCredentials: true,
            withBar: "Bar"
        });
        avalanche.removeAllRequestConfigs();
        expect(avalanche.getRequestConfig()).toStrictEqual({});
    });
});
describe("HTTP Operations", () => {
    const host = "127.0.0.1";
    const port = 8080;
    const protocol = "http";
    const path = "/ext/testingrequests";
    let avalanche;
    beforeAll(() => {
        avalanche = new src_1.Avalanche(host, port, protocol, 12345, undefined, undefined, undefined, true);
        avalanche.addAPI("testingrequests", testlib_1.TestAPI, path);
    });
    afterEach(() => {
        jest_mock_axios_1.default.reset();
    });
    test("GET works", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = "TestGET";
        const api = avalanche.api("testingrequests");
        const result = api.TestGET(input, `/${input}`);
        const payload = {
            result: {
                output: input
            }
        };
        const responseObj = {
            data: payload
        };
        jest_mock_axios_1.default.mockResponse(responseObj);
        const response = yield result;
        expect(jest_mock_axios_1.default.request).toHaveBeenCalledTimes(1);
        expect(response.output).toBe(input);
    }));
    test("DELETE works", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = "TestDELETE";
        const api = avalanche.api("testingrequests");
        const axiosConfig = {
            baseURL: `${protocol}://${host}:${port}`,
            responseType: "text"
        };
        const result = api.TestDELETE(input, `/${input}`, axiosConfig);
        const payload = {
            result: {
                output: input
            }
        };
        const responseObj = {
            data: payload
        };
        jest_mock_axios_1.default.mockResponse(responseObj);
        const response = yield result;
        expect(jest_mock_axios_1.default.request).toHaveBeenCalledTimes(1);
        expect(response.output).toBe(input);
    }));
    test("POST works", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = "TestPOST";
        const api = avalanche.api("testingrequests");
        const result = api.TestPOST(input, `/${input}`);
        const payload = {
            result: {
                output: input
            }
        };
        const responseObj = {
            data: payload
        };
        jest_mock_axios_1.default.mockResponse(responseObj);
        const response = yield result;
        expect(jest_mock_axios_1.default.request).toHaveBeenCalledTimes(1);
        expect(response.output).toBe(input);
    }));
    test("PUT works", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = "TestPUT";
        const api = avalanche.api("testingrequests");
        const result = api.TestPUT(input, `/${input}`);
        const payload = {
            result: {
                output: input
            }
        };
        const responseObj = {
            data: payload
        };
        jest_mock_axios_1.default.mockResponse(responseObj);
        const response = yield result;
        expect(jest_mock_axios_1.default.request).toHaveBeenCalledTimes(1);
        expect(response.output).toBe(input);
    }));
    test("PATCH works", () => __awaiter(void 0, void 0, void 0, function* () {
        const input = "TestPATCH";
        const api = avalanche.api("testingrequests");
        const result = api.TestPATCH(input, `/${input}`);
        const payload = {
            result: {
                output: input
            }
        };
        const responseObj = {
            data: payload
        };
        jest_mock_axios_1.default.mockResponse(responseObj);
        const response = yield result;
        expect(jest_mock_axios_1.default.request).toHaveBeenCalledTimes(1);
        expect(response.output).toBe(input);
    }));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXZhbGFuY2hlLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi90ZXN0cy9hdmFsYW5jaGUudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBLHNFQUF1QztBQUN2QyxnQ0FBa0M7QUFDbEMsNkNBQTRDO0FBQzVDLCtDQUFnRDtBQUNoRCxnREFBa0Q7QUFDbEQsOENBQThDO0FBQzlDLGtEQUFzRDtBQUN0RCxpREFBb0Q7QUFDcEQsb0RBQTBEO0FBQzFELHVDQUFtQztBQUluQyxRQUFRLENBQUMsV0FBVyxFQUFFLEdBQVMsRUFBRTtJQUMvQixNQUFNLFlBQVksR0FDaEIsbURBQW1ELENBQUE7SUFDckQsTUFBTSxJQUFJLEdBQVcsV0FBVyxDQUFBO0lBQ2hDLE1BQU0sSUFBSSxHQUFXLElBQUksQ0FBQTtJQUN6QixNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUE7SUFDeEIsSUFBSSxTQUFvQixDQUFBO0lBQ3hCLFNBQVMsQ0FBQyxHQUFTLEVBQUU7UUFDbkIsU0FBUyxHQUFHLElBQUksZUFBUyxDQUN2QixJQUFJLEVBQ0osSUFBSSxFQUNKLFFBQVEsRUFDUixLQUFLLEVBQ0wsU0FBUyxFQUNULFNBQVMsRUFDVCxTQUFTLEVBQ1QsSUFBSSxDQUNMLENBQUE7UUFDRCxTQUFTLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxjQUFRLENBQUMsQ0FBQTtRQUNuQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxZQUFNLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxDQUFDLENBQUE7UUFDbkUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsZUFBUyxDQUFDLENBQUE7UUFDckMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsYUFBTyxDQUFDLENBQUE7UUFDakMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsaUJBQVcsQ0FBQyxDQUFBO1FBQ3pDLFNBQVMsQ0FBQyxNQUFNLENBQUMsU0FB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c1wiXG5pbXBvcnQgeyBBdmFsYW5jaGUgfSBmcm9tIFwiLi4vc3JjXCJcbmltcG9ydCB7IEFWTUFQSSB9IGZyb20gXCIuLi9zcmMvYXBpcy9hdm0vYXBpXCJcbmltcG9ydCB7IEFkbWluQVBJIH0gZnJvbSBcIi4uL3NyYy9hcGlzL2FkbWluL2FwaVwiXG5pbXBvcnQgeyBIZWFsdGhBUEkgfSBmcm9tIFwiLi4vc3JjL2FwaXMvaGVhbHRoL2FwaVwiXG5pbXBvcnQgeyBJbmZvQVBJIH0gZnJvbSBcIi4uL3NyYy9hcGlzL2luZm8vYXBpXCJcbmltcG9ydCB7IEtleXN0b3JlQVBJIH0gZnJvbSBcIi4uL3NyYy9hcGlzL2tleXN0b3JlL2FwaVwiXG5pbXBvcnQgeyBNZXRyaWNzQVBJIH0gZnJvbSBcIi4uL3NyYy9hcGlzL21ldHJpY3MvYXBpXCJcbmltcG9ydCB7IFBsYXRmb3JtVk1BUEkgfSBmcm9tIFwiLi4vc3JjL2FwaXMvcGxhdGZvcm12bS9hcGlcIlxuaW1wb3J0IHsgVGVzdEFQSSB9IGZyb20gXCIuL3Rlc3RsaWJcIlxuaW1wb3J0IHsgQXhpb3NSZXF1ZXN0Q29uZmlnIH0gZnJvbSBcImF4aW9zXCJcbmltcG9ydCB7IEh0dHBSZXNwb25zZSB9IGZyb20gXCJqZXN0LW1vY2stYXhpb3MvZGlzdC9saWIvbW9jay1heGlvcy10eXBlc1wiXG5cbmRlc2NyaWJlKFwiQXZhbGFuY2hlXCIsICgpOiB2b2lkID0+IHtcbiAgY29uc3QgYmxvY2tjaGFpbklEOiBzdHJpbmcgPVxuICAgIFwiNmgyczVkZTFWQzY1bWVhakUxTDJQanZaMU1YdkhjM0Y2ZXFQQ0dLdUR0NE14aXdlRlwiXG4gIGNvbnN0IGhvc3Q6IHN0cmluZyA9IFwiMTI3LjAuMC4xXCJcbiAgY29uc3QgcG9ydDogbnVtYmVyID0gOTY1MFxuICBjb25zdCBwcm90b2NvbCA9IFwiaHR0cHNcIlxuICBsZXQgYXZhbGFuY2hlOiBBdmFsYW5jaGVcbiAgYmVmb3JlQWxsKCgpOiB2b2lkID0+IHtcbiAgICBhdmFsYW5jaGUgPSBuZXcgQXZhbGFuY2hlKFxuICAgICAgaG9zdCxcbiAgICAgIHBvcnQsXG4gICAgICBwcm90b2NvbCxcbiAgICAgIDEyMzQ1LFxuICAgICAgdW5kZWZpbmVkLFxuICAgICAgdW5kZWZpbmVkLFxuICAgICAgdW5kZWZpbmVkLFxuICAgICAgdHJ1ZVxuICAgIClcbiAgICBhdmFsYW5jaGUuYWRkQVBJKFwiYWRtaW5cIiwgQWRtaW5BUEkpXG4gICAgYXZhbGFuY2hlLmFkZEFQSShcInhjaGFpblwiLCBBVk1BUEksIFwiL2V4dC9zdWJuZXQvYXZtXCIsIGJsb2NrY2hhaW5JRClcbiAgICBhdmFsYW5jaGUuYWRkQVBJKFwiaGVhbHRoXCIsIEhlYWx0aEFQSSlcbiAgICBhdmFsYW5jaGUuYWRkQVBJKFwiaW5mb1wiLCBJbmZvQVBJKVxuICAgIGF2YWxhbmNoZS5hZGRBUEkoXCJrZXlzdG9yZVwiLCBLZXlzdG9yZUFQSSlcbiAgICBhdmFsYW5jaGUuYWRkQVBJKFwibWV0cmljc1wiLCBNZXRyaWNzQVBJKVxuICAgIGF2YWxhbmNoZS5hZGRBUEkoXCJwY2hhaW5cIiwgUGxhdGZvcm1WTUFQSSlcbiAgfSlcbiAgdGVzdChcIkNhbiBpbml0aWFsaXplIHdpdGhvdXQgcG9ydFwiLCAoKTogdm9pZCA9PiB7XG4gICAgY29uc3QgYSA9IG5ldyBBdmFsYW5jaGUoaG9zdCwgdW5kZWZpbmVkLCBwcm90b2NvbCwgMTIzNDUpXG4gICAgZXhwZWN0KGEuZ2V0UG9ydCgpKS50b0JlKHVuZGVmaW5lZClcbiAgICBleHBlY3QoYS5nZXRVUkwoKSkudG9CZShgJHtwcm90b2NvbH06Ly8ke2hvc3R9YClcbiAgfSlcbiAgdGVzdChcIkNhbiBpbml0aWFsaXplIHdpdGggcG9ydFwiLCAoKTogdm9pZCA9PiB7XG4gICAgZXhwZWN0KGF2YWxhbmNoZS5nZXRJUCgpKS50b0JlKGhvc3QpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5nZXRIb3N0KCkpLnRvQmUoaG9zdClcbiAgICBleHBlY3QoYXZhbGFuY2hlLmdldFBvcnQoKSkudG9CZShwb3J0KVxuICAgIGV4cGVjdChhdmFsYW5jaGUuZ2V0UHJvdG9jb2woKSkudG9CZShwcm90b2NvbClcbiAgICBleHBlY3QoYXZhbGFuY2hlLmdldFVSTCgpKS50b0JlKGAke3Byb3RvY29sfTovLyR7aG9zdH06JHtwb3J0fWApXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5nZXROZXR3b3JrSUQoKSkudG9CZSgxMjM0NSlcbiAgICBleHBlY3QoYXZhbGFuY2hlLmdldEhlYWRlcnMoKSkudG9TdHJpY3RFcXVhbCh7fSlcbiAgICBhdmFsYW5jaGUuc2V0TmV0d29ya0lEKDUwKVxuICAgIGV4cGVjdChhdmFsYW5jaGUuZ2V0TmV0d29ya0lEKCkpLnRvQmUoNTApXG4gICAgYXZhbGFuY2hlLnNldE5ldHdvcmtJRCgxMjM0NSlcbiAgICBleHBlY3QoYXZhbGFuY2hlLmdldE5ldHdvcmtJRCgpKS50b0JlKDEyMzQ1KVxuICB9KVxuXG4gIHRlc3QoXCJFbmRwb2ludHMgY29ycmVjdFwiLCAoKTogdm9pZCA9PiB7XG4gICAgZXhwZWN0KGF2YWxhbmNoZS5BZG1pbigpKS5ub3QudG9CZUluc3RhbmNlT2YoQVZNQVBJKVxuICAgIGV4cGVjdChhdmFsYW5jaGUuQWRtaW4oKSkudG9CZUluc3RhbmNlT2YoQWRtaW5BUEkpXG5cbiAgICBleHBlY3QoYXZhbGFuY2hlLlhDaGFpbigpKS5ub3QudG9CZUluc3RhbmNlT2YoQWRtaW5BUEkpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5YQ2hhaW4oKSkudG9CZUluc3RhbmNlT2YoQVZNQVBJKVxuXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5IZWFsdGgoKSkubm90LnRvQmVJbnN0YW5jZU9mKEtleXN0b3JlQVBJKVxuICAgIGV4cGVjdChhdmFsYW5jaGUuSGVhbHRoKCkpLnRvQmVJbnN0YW5jZU9mKEhlYWx0aEFQSSlcblxuICAgIGV4cGVjdChhdmFsYW5jaGUuSW5mbygpKS5ub3QudG9CZUluc3RhbmNlT2YoS2V5c3RvcmVBUEkpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5JbmZvKCkpLnRvQmVJbnN0YW5jZU9mKEluZm9BUEkpXG5cbiAgICBleHBlY3QoYXZhbGFuY2hlLlBDaGFpbigpKS5ub3QudG9CZUluc3RhbmNlT2YoS2V5c3RvcmVBUEkpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5QQ2hhaW4oKSkudG9CZUluc3RhbmNlT2YoUGxhdGZvcm1WTUFQSSlcblxuICAgIGV4cGVjdChhdmFsYW5jaGUuTm9kZUtleXMoKSkubm90LnRvQmVJbnN0YW5jZU9mKFBsYXRmb3JtVk1BUEkpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5Ob2RlS2V5cygpKS50b0JlSW5zdGFuY2VPZihLZXlzdG9yZUFQSSlcblxuICAgIGV4cGVjdChhdmFsYW5jaGUuTWV0cmljcygpKS5ub3QudG9CZUluc3RhbmNlT2YoS2V5c3RvcmVBUEkpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5NZXRyaWNzKCkpLnRvQmVJbnN0YW5jZU9mKE1ldHJpY3NBUEkpXG5cbiAgICBleHBlY3QoYXZhbGFuY2hlLkFkbWluKCkuZ2V0UlBDSUQoKSkudG9CZSgxKVxuICAgIGV4cGVjdChhdmFsYW5jaGUuWENoYWluKCkuZ2V0UlBDSUQoKSkudG9CZSgxKVxuICAgIGV4cGVjdChhdmFsYW5jaGUuUENoYWluKCkuZ2V0UlBDSUQoKSkudG9CZSgxKVxuICAgIGV4cGVjdChhdmFsYW5jaGUuTm9kZUtleXMoKS5nZXRSUENJRCgpKS50b0JlKDEpXG4gIH0pXG5cbiAgdGVzdChcIkNyZWF0ZSBuZXcgQVBJXCIsICgpOiB2b2lkID0+IHtcbiAgICBhdmFsYW5jaGUuYWRkQVBJKFwiYXZtMlwiLCBBVk1BUEkpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5hcGkoXCJhdm0yXCIpKS50b0JlSW5zdGFuY2VPZihBVk1BUEkpXG5cbiAgICBhdmFsYW5jaGUuYWRkQVBJKFwia2V5c3RvcmUyXCIsIEtleXN0b3JlQVBJLCBcIi9leHQva2V5c3RvcmUyXCIpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5hcGkoXCJrZXlzdG9yZTJcIikpLnRvQmVJbnN0YW5jZU9mKEtleXN0b3JlQVBJKVxuXG4gICAgYXZhbGFuY2hlLmFwaShcImtleXN0b3JlMlwiKS5zZXRCYXNlVVJMKFwiL2V4dC9rZXlzdG9yZTNcIilcbiAgICBleHBlY3QoYXZhbGFuY2hlLmFwaShcImtleXN0b3JlMlwiKS5nZXRCYXNlVVJMKCkpLnRvQmUoXCIvZXh0L2tleXN0b3JlM1wiKVxuXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5hcGkoXCJrZXlzdG9yZTJcIikuZ2V0REIoKSkudG9IYXZlUHJvcGVydHkoXCJuYW1lc3BhY2VcIilcbiAgfSlcblxuICB0ZXN0KFwiQ3VzdG9taXplIGhlYWRlcnNcIiwgKCk6IHZvaWQgPT4ge1xuICAgIGF2YWxhbmNoZS5zZXRIZWFkZXIoXCJYLUN1c3RvbS1IZWFkZXJcIiwgXCJleGFtcGxlXCIpXG4gICAgYXZhbGFuY2hlLnNldEhlYWRlcihcIlgtRm9vXCIsIFwiRm9vXCIpXG4gICAgYXZhbGFuY2hlLnNldEhlYWRlcihcIlgtQmFyXCIsIFwiQmFyXCIpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5nZXRIZWFkZXJzKCkpLnRvU3RyaWN0RXF1YWwoe1xuICAgICAgXCJYLUN1c3RvbS1IZWFkZXJcIjogXCJleGFtcGxlXCIsXG4gICAgICBcIlgtRm9vXCI6IFwiRm9vXCIsXG4gICAgICBcIlgtQmFyXCI6IFwiQmFyXCJcbiAgICB9KVxuICAgIGF2YWxhbmNoZS5yZW1vdmVIZWFkZXIoXCJYLUZvb1wiKVxuICAgIGV4cGVjdChhdmFsYW5jaGUuZ2V0SGVhZGVycygpKS50b1N0cmljdEVxdWFsKHtcbiAgICAgIFwiWC1DdXN0b20tSGVhZGVyXCI6IFwiZXhhbXBsZVwiLFxuICAgICAgXCJYLUJhclwiOiBcIkJhclwiXG4gICAgfSlcbiAgICBhdmFsYW5jaGUucmVtb3ZlQWxsSGVhZGVycygpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5nZXRIZWFkZXJzKCkpLnRvU3RyaWN0RXF1YWwoe30pXG4gIH0pXG5cbiAgdGVzdChcIkN1c3RvbWl6ZSByZXF1ZXN0IGNvbmZpZ1wiLCAoKTogdm9pZCA9PiB7XG4gICAgZXhwZWN0KGF2YWxhbmNoZS5nZXRSZXF1ZXN0Q29uZmlnKCkpLnRvU3RyaWN0RXF1YWwoe30pXG4gICAgYXZhbGFuY2hlLnNldFJlcXVlc3RDb25maWcoXCJ3aXRoQ3JlZGVudGlhbHNcIiwgdHJ1ZSlcbiAgICBhdmFsYW5jaGUuc2V0UmVxdWVzdENvbmZpZyhcIndpdGhGb29cIiwgXCJGb29cIilcbiAgICBhdmFsYW5jaGUuc2V0UmVxdWVzdENvbmZpZyhcIndpdGhCYXJcIiwgXCJCYXJcIilcbiAgICBleHBlY3QoYXZhbGFuY2hlLmdldFJlcXVlc3RDb25maWcoKSkudG9TdHJpY3RFcXVhbCh7XG4gICAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWUsXG4gICAgICB3aXRoRm9vOiBcIkZvb1wiLFxuICAgICAgd2l0aEJhcjogXCJCYXJcIlxuICAgIH0pXG4gICAgYXZhbGFuY2hlLnJlbW92ZVJlcXVlc3RDb25maWcoXCJ3aXRoRm9vXCIpXG4gICAgZXhwZWN0KGF2YWxhbmNoZS5nZXRSZXF1ZXN0Q29uZmlnKCkpLnRvU3RyaWN0RXF1YWwoe1xuICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlLFxuICAgICAgd2l0aEJhcjogXCJCYXJcIlxuICAgIH0pXG4gICAgYXZhbGFuY2hlLnJlbW92ZUFsbFJlcXVlc3RDb25maWdzKClcbiAgICBleHBlY3QoYXZhbGFuY2hlLmdldFJlcXVlc3RDb25maWcoKSkudG9TdHJpY3RFcXVhbCh7fSlcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKFwiSFRUUCBPcGVyYXRpb25zXCIsICgpOiB2b2lkID0+IHtcbiAgY29uc3QgaG9zdDogc3RyaW5nID0gXCIxMjcuMC4wLjFcIlxuICBjb25zdCBwb3J0OiBudW1iZXIgPSA4MDgwXG4gIGNvbnN0IHByb3RvY29sOiBzdHJpbmcgPSBcImh0dHBcIlxuICBjb25zdCBwYXRoOiBzdHJpbmcgPSBcIi9leHQvdGVzdGluZ3JlcXVlc3RzXCJcbiAgbGV0IGF2YWxhbmNoZTogQXZhbGFuY2hlXG4gIGJlZm9yZUFsbCgoKTogdm9pZCA9PiB7XG4gICAgYXZhbGFuY2hlID0gbmV3IEF2YWxhbmNoZShcbiAgICAgIGhvc3QsXG4gICAgICBwb3J0LFxuICAgICAgcHJvdG9jb2wsXG4gICAgICAxMjM0NSxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIHRydWVcbiAgICApXG4gICAgYXZhbGFuY2hlLmFkZEFQSShcInRlc3RpbmdyZXF1ZXN0c1wiLCBUZXN0QVBJLCBwYXRoKVxuICB9KVxuXG4gIGFmdGVyRWFjaCgoKTogdm9pZCA9PiB7XG4gICAgbW9ja0F4aW9zLnJlc2V0KClcbiAgfSlcblxuICB0ZXN0KFwiR0VUIHdvcmtzXCIsIGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBjb25zdCBpbnB1dDogc3RyaW5nID0gXCJUZXN0R0VUXCJcbiAgICBjb25zdCBhcGk6IFRlc3RBUEkgPSBhdmFsYW5jaGUuYXBpKFwidGVzdGluZ3JlcXVlc3RzXCIpXG4gICAgY29uc3QgcmVzdWx0OiBQcm9taXNlPG9iamVjdD4gPSBhcGkuVGVzdEdFVChpbnB1dCwgYC8ke2lucHV0fWApXG4gICAgY29uc3QgcGF5bG9hZDogb2JqZWN0ID0ge1xuICAgICAgcmVzdWx0OiB7XG4gICAgICAgIG91dHB1dDogaW5wdXRcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2VPYmo6IEh0dHBSZXNwb25zZSA9IHtcbiAgICAgIGRhdGE6IHBheWxvYWRcbiAgICB9XG4gICAgbW9ja0F4aW9zLm1vY2tSZXNwb25zZShyZXNwb25zZU9iailcbiAgICBjb25zdCByZXNwb25zZTogYW55ID0gYXdhaXQgcmVzdWx0XG4gICAgZXhwZWN0KG1vY2tBeGlvcy5yZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSlcbiAgICBleHBlY3QocmVzcG9uc2Uub3V0cHV0KS50b0JlKGlucHV0KVxuICB9KVxuXG4gIHRlc3QoXCJERUxFVEUgd29ya3NcIiwgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIGNvbnN0IGlucHV0OiBzdHJpbmcgPSBcIlRlc3RERUxFVEVcIlxuICAgIGNvbnN0IGFwaTogVGVzdEFQSSA9IGF2YWxhbmNoZS5hcGkoXCJ0ZXN0aW5ncmVxdWVzdHNcIilcbiAgICBjb25zdCBheGlvc0NvbmZpZzogQXhpb3NSZXF1ZXN0Q29uZmlnID0ge1xuICAgICAgYmFzZVVSTDogYCR7cHJvdG9jb2x9Oi8vJHtob3N0fToke3BvcnR9YCxcbiAgICAgIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCJcbiAgICB9XG4gICAgY29uc3QgcmVzdWx0OiBQcm9taXNlPG9iamVjdD4gPSBhcGkuVGVzdERFTEVURShcbiAgICAgIGlucHV0LFxuICAgICAgYC8ke2lucHV0fWAsXG4gICAgICBheGlvc0NvbmZpZ1xuICAgIClcbiAgICBjb25zdCBwYXlsb2FkOiBvYmplY3QgPSB7XG4gICAgICByZXN1bHQ6IHtcbiAgICAgICAgb3V0cHV0OiBpbnB1dFxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXNwb25zZU9iajogSHR0cFJlc3BvbnNlID0ge1xuICAgICAgZGF0YTogcGF5bG9hZFxuICAgIH1cbiAgICBtb2NrQXhpb3MubW9ja1Jlc3BvbnNlKHJlc3BvbnNlT2JqKVxuICAgIGNvbnN0IHJlc3BvbnNlOiBhbnkgPSBhd2FpdCByZXN1bHRcbiAgICBleHBlY3QobW9ja0F4aW9zLnJlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKVxuICAgIGV4cGVjdChyZXNwb25zZS5vdXRwdXQpLnRvQmUoaW5wdXQpXG4gIH0pXG5cbiAgdGVzdChcIlBPU1Qgd29ya3NcIiwgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIGNvbnN0IGlucHV0OiBzdHJpbmcgPSBcIlRlc3RQT1NUXCJcbiAgICBjb25zdCBhcGk6IFRlc3RBUEkgPSBhdmFsYW5jaGUuYXBpKFwidGVzdGluZ3JlcXVlc3RzXCIpXG4gICAgY29uc3QgcmVzdWx0OiBQcm9taXNlPG9iamVjdD4gPSBhcGkuVGVzdFBPU1QoaW5wdXQsIGAvJHtpbnB1dH1gKVxuICAgIGNvbnN0IHBheWxvYWQ6IG9iamVjdCA9IHtcbiAgICAgIHJlc3VsdDoge1xuICAgICAgICBvdXRwdXQ6IGlucHV0XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlT2JqOiBIdHRwUmVzcG9uc2UgPSB7XG4gICAgICBkYXRhOiBwYXlsb2FkXG4gICAgfVxuICAgIG1vY2tBeGlvcy5tb2NrUmVzcG9uc2UocmVzcG9uc2VPYmopXG4gICAgY29uc3QgcmVzcG9uc2U6IGFueSA9IGF3YWl0IHJlc3VsdFxuICAgIGV4cGVjdChtb2NrQXhpb3MucmVxdWVzdCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpXG4gICAgZXhwZWN0KHJlc3BvbnNlLm91dHB1dCkudG9CZShpbnB1dClcbiAgfSlcblxuICB0ZXN0KFwiUFVUIHdvcmtzXCIsIGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBjb25zdCBpbnB1dDogc3RyaW5nID0gXCJUZXN0UFVUXCJcbiAgICBjb25zdCBhcGk6IFRlc3RBUEkgPSBhdmFsYW5jaGUuYXBpKFwidGVzdGluZ3JlcXVlc3RzXCIpXG4gICAgY29uc3QgcmVzdWx0OiBQcm9taXNlPG9iamVjdD4gPSBhcGkuVGVzdFBVVChpbnB1dCwgYC8ke2lucHV0fWApXG4gICAgY29uc3QgcGF5bG9hZDogb2JqZWN0ID0ge1xuICAgICAgcmVzdWx0OiB7XG4gICAgICAgIG91dHB1dDogaW5wdXRcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2VPYmo6IEh0dHBSZXNwb25zZSA9IHtcbiAgICAgIGRhdGE6IHBheWxvYWRcbiAgICB9XG4gICAgbW9ja0F4aW9zLm1vY2tSZXNwb25zZShyZXNwb25zZU9iailcbiAgICBjb25zdCByZXNwb25zZTogYW55ID0gYXdhaXQgcmVzdWx0XG4gICAgZXhwZWN0KG1vY2tBeGlvcy5yZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSlcbiAgICBleHBlY3QocmVzcG9uc2Uub3V0cHV0KS50b0JlKGlucHV0KVxuICB9KVxuXG4gIHRlc3QoXCJQQVRDSCB3b3Jrc1wiLCBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgY29uc3QgaW5wdXQ6IHN0cmluZyA9IFwiVGVzdFBBVENIXCJcbiAgICBjb25zdCBhcGk6IFRlc3RBUEkgPSBhdmFsYW5jaGUuYXBpKFwidGVzdGluZ3JlcXVlc3RzXCIpXG4gICAgY29uc3QgcmVzdWx0OiBQcm9taXNlPG9iamVjdD4gPSBhcGkuVGVzdFBBVENIKGlucHV0LCBgLyR7aW5wdXR9YClcbiAgICBjb25zdCBwYXlsb2FkOiBvYmplY3QgPSB7XG4gICAgICByZXN1bHQ6IHtcbiAgICAgICAgb3V0cHV0OiBpbnB1dFxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXNwb25zZU9iajogSHR0cFJlc3BvbnNlID0ge1xuICAgICAgZGF0YTogcGF5bG9hZFxuICAgIH1cbiAgICBtb2NrQXhpb3MubW9ja1Jlc3BvbnNlKHJlc3BvbnNlT2JqKVxuICAgIGNvbnN0IHJlc3BvbnNlOiBhbnkgPSBhd2FpdCByZXN1bHRcbiAgICBleHBlY3QobW9ja0F4aW9zLnJlcXVlc3QpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKVxuICAgIGV4cGVjdChyZXNwb25zZS5vdXRwdXQpLnRvQmUoaW5wdXQpXG4gIH0pXG59KVxuIl19