"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const buffer_1 = require("buffer/");
const bintools_1 = __importDefault(require("../../../src/utils/bintools"));
const credentials_1 = require("../../../src/common/credentials");
const output_1 = require("../../../src/common/output");
const helperfunctions_1 = require("../../../src/utils/helperfunctions");
const bintools = bintools_1.default.getInstance();
describe("UnixNow", () => {
    test("Does it return the right time?", () => {
        const now = Math.round(new Date().getTime() / 1000);
        const unow = helperfunctions_1.UnixNow();
        expect(now / 10).toBeCloseTo(unow.divn(10).toNumber(), -1);
    });
});
describe("Signature & NBytes", () => {
    const sig = new credentials_1.Signature();
    const sigpop = [];
    for (let i = 0; i < sig.getSize(); i++) {
        sigpop[i] = i;
    }
    const sigbuff = buffer_1.Buffer.from(sigpop);
    const size = sig.fromBuffer(sigbuff);
    expect(sig.getSize()).toBe(size);
    expect(size).toBe(sig.getSize());
    const sigbuff2 = sig.toBuffer();
    for (let i = 0; i < sigbuff.length; i++) {
        expect(sigbuff2[i]).toBe(sigbuff[i]);
    }
    const sigbuffstr = bintools.bufferToB58(sigbuff);
    expect(sig.toString()).toBe(sigbuffstr);
    sig.fromString(sigbuffstr);
    expect(sig.toString()).toBe(sigbuffstr);
});
describe("SigIdx", () => {
    const sigidx = new credentials_1.SigIdx();
    expect(sigidx.getSize()).toBe(sigidx.toBuffer().length);
    sigidx.setSource(buffer_1.Buffer.from("abcd", "hex"));
    expect(sigidx.getSource().toString("hex")).toBe("abcd");
});
describe("Address", () => {
    const addr1 = new output_1.Address();
    const addr2 = new output_1.Address();
    const smaller = [
        0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0
    ];
    const bigger = [
        0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 8, 7, 6, 5, 4, 3, 2, 1, 1
    ];
    const addr1bytes = buffer_1.Buffer.from(smaller);
    const addr2bytes = buffer_1.Buffer.from(bigger);
    addr1.fromBuffer(addr1bytes);
    addr2.fromBuffer(addr2bytes);
    expect(output_1.Address.comparator()(addr1, addr2)).toBe(-1);
    expect(output_1.Address.comparator()(addr2, addr1)).toBe(1);
    const addr2str = addr2.toString();
    addr2.fromBuffer(addr1bytes);
    expect(output_1.Address.comparator()(addr1, addr2)).toBe(0);
    addr2.fromString(addr2str);
    expect(output_1.Address.comparator()(addr1, addr2)).toBe(-1);
    const a1b = addr1.toBuffer();
    const a1s = bintools.bufferToB58(a1b);
    addr2.fromString(a1s);
    expect(output_1.Address.comparator()(addr1, addr2)).toBe(0);
    const badbuff = bintools.copyFrom(addr1bytes);
    let badbuffout = buffer_1.Buffer.concat([badbuff, buffer_1.Buffer.from([1, 2])]);
    let badstr = bintools.bufferToB58(badbuffout);
    const badaddr = new output_1.Address();
    expect(() => {
        badaddr.fromString(badstr);
    }).toThrow("Error - Address.fromString: invalid address");
    badbuffout = buffer_1.Buffer.concat([badbuff, buffer_1.Buffer.from([1, 2, 3, 4])]);
    badstr = bintools.bufferToB58(badbuffout);
    expect(() => {
        badaddr.fromString(badstr);
    }).toThrow("Error - Address.fromString: invalid checksum on address");
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZXMudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3RzL2FwaXMvYXZtL3R5cGVzLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxvQ0FBZ0M7QUFDaEMsMkVBQWtEO0FBQ2xELGlFQUFtRTtBQUNuRSx1REFBb0Q7QUFDcEQsd0VBQTREO0FBRzVELE1BQU0sUUFBUSxHQUFhLGtCQUFRLENBQUMsV0FBVyxFQUFFLENBQUE7QUFFakQsUUFBUSxDQUFDLFNBQVMsRUFBRSxHQUFTLEVBQUU7SUFDN0IsSUFBSSxDQUFDLGdDQUFnQyxFQUFFLEdBQVMsRUFBRTtRQUNoRCxNQUFNLEdBQUcsR0FBVyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUE7UUFDM0QsTUFBTSxJQUFJLEdBQU8seUJBQU8sRUFBRSxDQUFBO1FBQzFCLE1BQU0sQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQTtJQUM1RCxDQUFDLENBQUMsQ0FBQTtBQUNKLENBQUMsQ0FBQyxDQUFBO0FBRUYsUUFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQVMsRUFBRTtJQUN4QyxNQUFNLEdBQUcsR0FBYyxJQUFJLHVCQUFTLEVBQUUsQ0FBQTtJQUN0QyxNQUFNLE1BQU0sR0FBYSxFQUFFLENBQUE7SUFDM0IsS0FBSyxJQUFJLENBQUMsR0FBVyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUM5QyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0tBQ2Q7SUFDRCxNQUFNLE9BQU8sR0FBVyxlQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FB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QUFFLGVBQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDdEUsSUFBSSxNQUFNLEdBQVcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUNyRCxNQUFNLE9BQU8sR0FBWSxJQUFJLGdCQUFPLEVBQUUsQ0FBQTtJQUV0QyxNQUFNLENBQUMsR0FBUyxFQUFFO1FBQ2hCLE9BQU8sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDNUIsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLDZDQUE2QyxDQUFDLENBQUE7SUFFekQsVUFBVSxHQUFHLGVBQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLEVBQUUsZUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ2hFLE1BQU0sR0FBRyxRQUFRLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFBO0lBQ3pDLE1BQU0sQ0FBQyxHQUFTLEVBQUU7UUFDaEIsT0FBTyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQTtJQUM1QixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMseURBQXlELENBQUMsQ0FBQTtBQUN2RSxDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJ1ZmZlciB9IGZyb20gXCJidWZmZXIvXCJcbmltcG9ydCBCaW5Ub29scyBmcm9tIFwiLi4vLi4vLi4vc3JjL3V0aWxzL2JpbnRvb2xzXCJcbmltcG9ydCB7IFNpZ0lkeCwgU2lnbmF0dXJlIH0gZnJvbSBcIi4uLy4uLy4uL3NyYy9jb21tb24vY3JlZGVudGlhbHNcIlxuaW1wb3J0IHsgQWRkcmVzcyB9IGZyb20gXCIuLi8uLi8uLi9zcmMvY29tbW9uL291dHB1dFwiXG5pbXBvcnQgeyBVbml4Tm93IH0gZnJvbSBcIi4uLy4uLy4uL3NyYy91dGlscy9oZWxwZXJmdW5jdGlvbnNcIlxuaW1wb3J0IEJOIGZyb20gXCJibi5qc1wiXG5cbmNvbnN0IGJpbnRvb2xzOiBCaW5Ub29scyA9IEJpblRvb2xzLmdldEluc3RhbmNlKClcblxuZGVzY3JpYmUoXCJVbml4Tm93XCIsICgpOiB2b2lkID0+IHtcbiAgdGVzdChcIkRvZXMgaXQgcmV0dXJuIHRoZSByaWdodCB0aW1lP1wiLCAoKTogdm9pZCA9PiB7XG4gICAgY29uc3Qgbm93OiBudW1iZXIgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMClcbiAgICBjb25zdCB1bm93OiBCTiA9IFVuaXhOb3coKVxuICAgIGV4cGVjdChub3cgLyAxMCkudG9CZUNsb3NlVG8odW5vdy5kaXZuKDEwKS50b051bWJlcigpLCAtMSlcbiAgfSlcbn0pXG5cbmRlc2NyaWJlKFwiU2lnbmF0dXJlICYgTkJ5dGVzXCIsICgpOiB2b2lkID0+IHtcbiAgY29uc3Qgc2lnOiBTaWduYXR1cmUgPSBuZXcgU2lnbmF0dXJlKClcbiAgY29uc3Qgc2lncG9wOiBudW1iZXJbXSA9IFtdXG4gIGZvciAobGV0IGk6IG51bWJlciA9IDA7IGkgPCBzaWcuZ2V0U2l6ZSgpOyBpKyspIHtcbiAgICBzaWdwb3BbaV0gPSBpXG4gIH1cbiAgY29uc3Qgc2lnYnVmZjogQnVmZmVyID0gQnVmZmVyLmZyb20oc2lncG9wKVxuICBjb25zdCBzaXplOiBudW1iZXIgPSBzaWcuZnJvbUJ1ZmZlcihzaWdidWZmKVxuICBleHBlY3Qoc2lnLmdldFNpemUoKSkudG9CZShzaXplKVxuICBleHBlY3Qoc2l6ZSkudG9CZShzaWcuZ2V0U2l6ZSgpKVxuICBjb25zdCBzaWdidWZmMjogQnVmZmVyID0gc2lnLnRvQnVmZmVyKClcbiAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IHNpZ2J1ZmYubGVuZ3RoOyBpKyspIHtcbiAgICBleHBlY3Qoc2lnYnVmZjJbaV0pLnRvQmUoc2lnYnVmZltpXSlcbiAgfVxuICBjb25zdCBzaWdidWZmc3RyOiBzdHJpbmcgPSBiaW50b29scy5idWZmZXJUb0I1OChzaWdidWZmKVxuICBleHBlY3Qoc2lnLnRvU3RyaW5nKCkpLnRvQmUoc2lnYnVmZnN0cilcbiAgc2lnLmZyb21TdHJpbmcoc2lnYnVmZnN0cilcbiAgZXhwZWN0KHNpZy50b1N0cmluZygpKS50b0JlKHNpZ2J1ZmZzdHIpXG59KVxuXG5kZXNjcmliZShcIlNpZ0lkeFwiLCAoKTogdm9pZCA9PiB7XG4gIGNvbnN0IHNpZ2lkeDogU2lnSWR4ID0gbmV3IFNpZ0lkeCgpXG4gIGV4cGVjdChzaWdpZHguZ2V0U2l6ZSgpKS50b0JlKHNpZ2lkeC50b0J1ZmZlcigpLmxlbmd0aClcbiAgc2lnaWR4LnNldFNvdXJjZShCdWZmZXIuZnJvbShcImFiY2RcIiwgXCJoZXhcIikpXG4gIGV4cGVjdChzaWdpZHguZ2V0U291cmNlKCkudG9TdHJpbmcoXCJoZXhcIikpLnRvQmUoXCJhYmNkXCIpXG59KVxuXG5kZXNjcmliZShcIkFkZHJlc3NcIiwgKCk6IHZvaWQgPT4ge1xuICBjb25zdCBhZGRyMTogQWRkcmVzcyA9IG5ldyBBZGRyZXNzKClcbiAgY29uc3QgYWRkcjI6IEFkZHJlc3MgPSBuZXcgQWRkcmVzcygpXG4gIGNvbnN0IHNtYWxsZXI6IG51bWJlcltdID0gW1xuICAgIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDksIDgsIDcsIDYsIDUsIDQsIDMsIDIsIDEsIDBcbiAgXVxuICBjb25zdCBiaWdnZXI6IG51bWJlcltdID0gW1xuICAgIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDksIDgsIDcsIDYsIDUsIDQsIDMsIDIsIDEsIDFcbiAgXVxuICBjb25zdCBhZGRyMWJ5dGVzOiBCdWZmZXIgPSBCdWZmZXIuZnJvbShzbWFsbGVyKVxuICBjb25zdCBhZGRyMmJ5dGVzOiBCdWZmZXIgPSBCdWZmZXIuZnJvbShiaWdnZXIpXG4gIGFkZHIxLmZyb21CdWZmZXIoYWRkcjFieXRlcylcbiAgYWRkcjIuZnJvbUJ1ZmZlcihhZGRyMmJ5dGVzKVxuICBleHBlY3QoQWRkcmVzcy5jb21wYXJhdG9yKCkoYWRkcjEsIGFkZHIyKSkudG9CZSgtMSlcbiAgZXhwZWN0KEFkZHJlc3MuY29tcGFyYXRvcigpKGFkZHIyLCBhZGRyMSkpLnRvQmUoMSlcblxuICBjb25zdCBhZGRyMnN0cjogc3RyaW5nID0gYWRkcjIudG9TdHJpbmcoKVxuXG4gIGFkZHIyLmZyb21CdWZmZXIoYWRkcjFieXRlcylcbiAgZXhwZWN0KEFkZHJlc3MuY29tcGFyYXRvcigpKGFkZHIxLCBhZGRyMikpLnRvQmUoMClcblxuICBhZGRyMi5mcm9tU3RyaW5nKGFkZHIyc3RyKVxuICBleHBlY3QoQWRkcmVzcy5jb21wYXJhdG9yKCkoYWRkcjEsIGFkZHIyKSkudG9CZSgtMSlcbiAgY29uc3QgYTFiOiBCdWZmZXIgPSBhZGRyMS50b0J1ZmZlcigpXG4gIGNvbnN0IGExczogc3RyaW5nID0gYmludG9vbHMuYnVmZmVyVG9CNTgoYTFiKVxuICBhZGRyMi5mcm9tU3RyaW5nKGExcylcbiAgZXhwZWN0KEFkZHJlc3MuY29tcGFyYXRvcigpKGFkZHIxLCBhZGRyMikpLnRvQmUoMClcblxuICBjb25zdCBiYWRidWZmOiBCdWZmZXIgPSBiaW50b29scy5jb3B5RnJvbShhZGRyMWJ5dGVzKVxuICBsZXQgYmFkYnVmZm91dDogQnVmZmVyID0gQnVmZmVyLmNvbmNhdChbYmFkYnVmZiwgQnVmZmVyLmZyb20oWzEsIDJdKV0pXG4gIGxldCBiYWRzdHI6IHN0cmluZyA9IGJpbnRvb2xzLmJ1ZmZlclRvQjU4KGJhZGJ1ZmZvdXQpXG4gIGNvbnN0IGJhZGFkZHI6IEFkZHJlc3MgPSBuZXcgQWRkcmVzcygpXG5cbiAgZXhwZWN0KCgpOiB2b2lkID0+IHtcbiAgICBiYWRhZGRyLmZyb21TdHJpbmcoYmFkc3RyKVxuICB9KS50b1Rocm93KFwiRXJyb3IgLSBBZGRyZXNzLmZyb21TdHJpbmc6IGludmFsaWQgYWRkcmVzc1wiKVxuXG4gIGJhZGJ1ZmZvdXQgPSBCdWZmZXIuY29uY2F0KFtiYWRidWZmLCBCdWZmZXIuZnJvbShbMSwgMiwgMywgNF0pXSlcbiAgYmFkc3RyID0gYmludG9vbHMuYnVmZmVyVG9CNTgoYmFkYnVmZm91dClcbiAgZXhwZWN0KCgpOiB2b2lkID0+IHtcbiAgICBiYWRhZGRyLmZyb21TdHJpbmcoYmFkc3RyKVxuICB9KS50b1Rocm93KFwiRXJyb3IgLSBBZGRyZXNzLmZyb21TdHJpbmc6IGludmFsaWQgY2hlY2tzdW0gb24gYWRkcmVzc1wiKVxufSlcbiJdfQ==