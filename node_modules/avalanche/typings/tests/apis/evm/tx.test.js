"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const evm_1 = require("../../../src/apis/evm");
const constants_1 = require("../../../src/utils/constants");
const constants_2 = require("../../../src/utils/constants");
const evm_2 = require("../../../src/apis/evm");
const bn_js_1 = __importDefault(require("bn.js"));
const src_1 = require("src");
const networkID = 12345;
const cHexAddress1 = "0x8db97C7cEcE249c2b98bDC0226Cc4C2A57BF52FC";
const bintools = src_1.BinTools.getInstance();
const cHexAddress2 = "0xecC3B2968B277b837a81A7181e0b94EB1Ca54EdE";
const antAssetID = "F4MyJcUvq3Rxbqgd4Zs8sUpvwLHApyrp4yxJXe2bAV86Vvp38";
const avaxAssetID = constants_1.Defaults.network[networkID].X.avaxAssetID;
const txID = "QVb7DtKjcwVYLFWHgnGSdzQtQSc29KeRBYFNCBnbFu6dFqX7z";
const blockchainID = constants_1.Defaults.network[networkID].C.blockchainID;
const sourcechainID = constants_1.Defaults.network[networkID].X.blockchainID;
let evmOutputs;
let importedIns;
const fee = constants_1.Defaults.network[networkID].C.txFee;
beforeEach(() => {
    evmOutputs = [];
    importedIns = [];
});
describe("EVM Transactions", () => {
    describe("ImportTx", () => {
        test("Multiple AVAX EVMOutput fail", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(constants_2.ONEAVAX);
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            // Creating 2 outputs with the same address and AVAX assetID is invalid
            let evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX, avaxAssetID);
            evmOutputs.push(evmOutput);
            evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX, avaxAssetID);
            evmOutputs.push(evmOutput);
            expect(() => {
                new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            }).toThrow("Error - ImportTx: duplicate (address, assetId) pair found in outputs: (0x8db97c7cece249c2b98bdc0226cc4c2a57bf52fc, 2fombhL7aGPwj3KH4bfrmJwW6PVnMobf9Y2fn9GwxiAAJyFDbe)");
        });
        test("Multiple AVAX EVMOutput success", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(constants_2.ONEAVAX);
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            // Creating 2 outputs with different addresses valid
            let evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX.div(new bn_js_1.default(3)), avaxAssetID);
            evmOutputs.push(evmOutput);
            evmOutput = new evm_2.EVMOutput(cHexAddress2, constants_2.ONEAVAX.div(new bn_js_1.default(3)), avaxAssetID);
            evmOutputs.push(evmOutput);
            const importTx = new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            expect(importTx).toBeInstanceOf(evm_1.ImportTx);
        });
        test("Multiple ANT EVMOutput fail", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(new bn_js_1.default(507));
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            // Creating 2 outputs with the same address and ANT assetID is invalid
            let evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX, antAssetID);
            evmOutputs.push(evmOutput);
            evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX, antAssetID);
            evmOutputs.push(evmOutput);
            expect(() => {
                new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            }).toThrow("Error - ImportTx: duplicate (address, assetId) pair found in outputs: (0x8db97c7cece249c2b98bdc0226cc4c2a57bf52fc, F4MyJcUvq3Rxbqgd4Zs8sUpvwLHApyrp4yxJXe2bAV86Vvp38)");
        });
        test("Multiple ANT EVMOutput success", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(fee);
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            let evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX, antAssetID);
            evmOutputs.push(evmOutput);
            evmOutput = new evm_2.EVMOutput(cHexAddress2, constants_2.ONEAVAX, antAssetID);
            evmOutputs.push(evmOutput);
            const importTx = new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            expect(importTx).toBeInstanceOf(evm_1.ImportTx);
        });
        test("Single ANT EVMOutput fail", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(new bn_js_1.default(0));
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            // If the output is a non-avax assetID then don't subtract a fee
            const evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX, antAssetID);
            evmOutputs.push(evmOutput);
            expect(() => {
                new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            }).toThrow("Error - 1000000 AVAX required for fee and only 0 AVAX provided");
        });
        test("Single ANT EVMOutput success", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(constants_2.ONEAVAX);
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            const evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX, antAssetID);
            evmOutputs.push(evmOutput);
            const importTx = new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            expect(importTx).toBeInstanceOf(evm_1.ImportTx);
        });
        test("Single AVAX EVMOutput fail", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(new bn_js_1.default(507));
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            const evmOutput = new evm_2.EVMOutput(cHexAddress1, new bn_js_1.default(0), avaxAssetID);
            evmOutputs.push(evmOutput);
            expect(() => {
                new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            }).toThrow("Error - 1000000 AVAX required for fee and only 507 AVAX provided");
        });
        test("Single AVAX EVMOutput success", () => {
            const outputidx = src_1.Buffer.from("");
            const input = new evm_1.SECPTransferInput(constants_2.ONEAVAX);
            const xferin = new evm_1.TransferableInput(bintools.cb58Decode(txID), outputidx, bintools.cb58Decode(avaxAssetID), input);
            importedIns.push(xferin);
            const evmOutput = new evm_2.EVMOutput(cHexAddress1, constants_2.ONEAVAX.sub(constants_1.MILLIAVAX), avaxAssetID);
            evmOutputs.push(evmOutput);
            const importTx = new evm_1.ImportTx(networkID, bintools.cb58Decode(blockchainID), bintools.cb58Decode(sourcechainID), importedIns, evmOutputs);
            expect(importTx).toBeInstanceOf(evm_1.ImportTx);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHgudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3RzL2FwaXMvZXZtL3R4LnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSwrQ0FJOEI7QUFDOUIsNERBQWtFO0FBQ2xFLDREQUFzRDtBQUN0RCwrQ0FBaUQ7QUFDakQsa0RBQXNCO0FBQ3RCLDZCQUFzQztBQUN0QyxNQUFNLFNBQVMsR0FBVyxLQUFLLENBQUE7QUFDL0IsTUFBTSxZQUFZLEdBQVcsNENBQTRDLENBQUE7QUFDekUsTUFBTSxRQUFRLEdBQWEsY0FBUSxDQUFDLFdBQVcsRUFBRSxDQUFBO0FBQ2pELE1BQU0sWUFBWSxHQUFXLDRDQUE0QyxDQUFBO0FBQ3pFLE1BQU0sVUFBVSxHQUFXLG1EQUFtRCxDQUFBO0FBQzlFLE1BQU0sV0FBVyxHQUFXLG9CQUFRLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUE7QUFDckUsTUFBTSxJQUFJLEdBQVcsbURBQW1ELENBQUE7QUFDeEUsTUFBTSxZQUFZLEdBQVcsb0JBQVEsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQTtBQUN2RSxNQUFNLGFBQWEsR0FBVyxvQkFBUSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFBO0FBQ3hFLElBQUksVUFBdUIsQ0FBQTtBQUMzQixJQUFJLFdBQWdDLENBQUE7QUFDcEMsTUFBTSxHQUFHLEdBQU8sb0JBQVEsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQTtBQUVuRCxVQUFVLENBQUMsR0FBUyxFQUFFO0lBQ3BCLFVBQVUsR0FBRyxFQUFFLENBQUE7SUFDZixXQUFXLEdBQUcsRUFBRSxDQUFBO0FBQ2xCLENBQUMsQ0FBQyxDQUFBO0FBRUYsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFB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O1lBQ3pDLE1BQU0sS0FBSyxHQUFzQixJQUFJLHVCQUFpQixDQUFDLG1CQUFPLENBQUMsQ0FBQTtZQUMvRCxNQUFNLE1BQU0sR0FBc0IsSUFBSSx1QkFBaUIsQ0FDckQsUUFBUSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFDekIsU0FBUyxFQUNULFFBQVEsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLEVBQ2hDLEtBQUssQ0FDTixDQUFBO1lBQ0QsV0FBVyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQTtZQUN4QixNQUFNLFNBQVMsR0FBYyxJQUFJLGVBQVMsQ0FDeEMsWUFBWSxFQUNaLG1CQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFTLENBQUMsRUFDdEIsV0FBVyxDQUNaLENBQUE7WUFDRCxVQUFVLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFBO1lBQzFCLE1BQU0sUUFBUSxHQUFhLElBQUksY0FBUSxDQUNyQyxTQUFTLEVBQ1QsUUFBUSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsRUFDakMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsRUFDbEMsV0FBVyxFQUNYLFVBQVUsQ0FDWCxDQUFBO1lBQ0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxjQUFRLENBQUMsQ0FBQTtRQUMzQyxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBJbXBvcnRUeCxcbiAgU0VDUFRyYW5zZmVySW5wdXQsXG4gIFRyYW5zZmVyYWJsZUlucHV0XG59IGZyb20gXCIuLi8uLi8uLi9zcmMvYXBpcy9ldm1cIlxuaW1wb3J0IHsgRGVmYXVsdHMsIE1JTExJQVZBWCB9IGZyb20gXCIuLi8uLi8uLi9zcmMvdXRpbHMvY29uc3RhbnRzXCJcbmltcG9ydCB7IE9ORUFWQVggfSBmcm9tIFwiLi4vLi4vLi4vc3JjL3V0aWxzL2NvbnN0YW50c1wiXG5pbXBvcnQgeyBFVk1PdXRwdXQgfSBmcm9tIFwiLi4vLi4vLi4vc3JjL2FwaXMvZXZtXCJcbmltcG9ydCBCTiBmcm9tIFwiYm4uanNcIlxuaW1wb3J0IHsgQmluVG9vbHMsIEJ1ZmZlciB9IGZyb20gXCJzcmNcIlxuY29uc3QgbmV0d29ya0lEOiBudW1iZXIgPSAxMjM0NVxuY29uc3QgY0hleEFkZHJlc3MxOiBzdHJpbmcgPSBcIjB4OGRiOTdDN2NFY0UyNDljMmI5OGJEQzAyMjZDYzRDMkE1N0JGNTJGQ1wiXG5jb25zdCBiaW50b29sczogQmluVG9vbHMgPSBCaW5Ub29scy5nZXRJbnN0YW5jZSgpXG5jb25zdCBjSGV4QWRkcmVzczI6IHN0cmluZyA9IFwiMHhlY0MzQjI5NjhCMjc3YjgzN2E4MUE3MTgxZTBiOTRFQjFDYTU0RWRFXCJcbmNvbnN0IGFudEFzc2V0SUQ6IHN0cmluZyA9IFwiRjRNeUpjVXZxM1J4YnFnZDRaczhzVXB2d0xIQXB5cnA0eXhKWGUyYkFWODZWdnAzOFwiXG5jb25zdCBhdmF4QXNzZXRJRDogc3RyaW5nID0gRGVmYXVsdHMubmV0d29ya1tuZXR3b3JrSURdLlguYXZheEFzc2V0SURcbmNvbnN0IHR4SUQ6IHN0cmluZyA9IFwiUVZiN0R0S2pjd1ZZTEZXSGduR1NkelF0UVNjMjlLZVJCWUZOQ0JuYkZ1NmRGcVg3elwiXG5jb25zdCBibG9ja2NoYWluSUQ6IHN0cmluZyA9IERlZmF1bHRzLm5ldHdvcmtbbmV0d29ya0lEXS5DLmJsb2NrY2hhaW5JRFxuY29uc3Qgc291cmNlY2hhaW5JRDogc3RyaW5nID0gRGVmYXVsdHMubmV0d29ya1tuZXR3b3JrSURdLlguYmxvY2tjaGFpbklEXG5sZXQgZXZtT3V0cHV0czogRVZNT3V0cHV0W11cbmxldCBpbXBvcnRlZEluczogVHJhbnNmZXJhYmxlSW5wdXRbXVxuY29uc3QgZmVlOiBCTiA9IERlZmF1bHRzLm5ldHdvcmtbbmV0d29ya0lEXS5DLnR4RmVlXG5cbmJlZm9yZUVhY2goKCk6IHZvaWQgPT4ge1xuICBldm1PdXRwdXRzID0gW11cbiAgaW1wb3J0ZWRJbnMgPSBbXVxufSlcblxuZGVzY3JpYmUoXCJFVk0gVHJhbnNhY3Rpb25zXCIsICgpID0+IHtcbiAgZGVzY3JpYmUoXCJJbXBvcnRUeFwiLCAoKSA9PiB7XG4gICAgdGVzdChcIk11bHRpcGxlIEFWQVggRVZNT3V0cHV0IGZhaWxcIiwgKCk6IHZvaWQgPT4ge1xuICAgICAgY29uc3Qgb3V0cHV0aWR4OiBCdWZmZXIgPSBCdWZmZXIuZnJvbShcIlwiKVxuICAgICAgY29uc3QgaW5wdXQ6IFNFQ1BUcmFuc2ZlcklucHV0ID0gbmV3IFNFQ1BUcmFuc2ZlcklucHV0KE9ORUFWQVgpXG4gICAgICBjb25zdCB4ZmVyaW46IFRyYW5zZmVyYWJsZUlucHV0ID0gbmV3IFRyYW5zZmVyYWJsZUlucHV0KFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHR4SUQpLFxuICAgICAgICBvdXRwdXRpZHgsXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoYXZheEFzc2V0SUQpLFxuICAgICAgICBpbnB1dFxuICAgICAgKVxuICAgICAgaW1wb3J0ZWRJbnMucHVzaCh4ZmVyaW4pXG4gICAgICAvLyBDcmVhdGluZyAyIG91dHB1dHMgd2l0aCB0aGUgc2FtZSBhZGRyZXNzIGFuZCBBVkFYIGFzc2V0SUQgaXMgaW52YWxpZFxuICAgICAgbGV0IGV2bU91dHB1dDogRVZNT3V0cHV0ID0gbmV3IEVWTU91dHB1dChcbiAgICAgICAgY0hleEFkZHJlc3MxLFxuICAgICAgICBPTkVBVkFYLFxuICAgICAgICBhdmF4QXNzZXRJRFxuICAgICAgKVxuICAgICAgZXZtT3V0cHV0cy5wdXNoKGV2bU91dHB1dClcbiAgICAgIGV2bU91dHB1dCA9IG5ldyBFVk1PdXRwdXQoY0hleEFkZHJlc3MxLCBPTkVBVkFYLCBhdmF4QXNzZXRJRClcbiAgICAgIGV2bU91dHB1dHMucHVzaChldm1PdXRwdXQpXG5cbiAgICAgIGV4cGVjdCgoKTogdm9pZCA9PiB7XG4gICAgICAgIG5ldyBJbXBvcnRUeChcbiAgICAgICAgICBuZXR3b3JrSUQsXG4gICAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShibG9ja2NoYWluSUQpLFxuICAgICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoc291cmNlY2hhaW5JRCksXG4gICAgICAgICAgaW1wb3J0ZWRJbnMsXG4gICAgICAgICAgZXZtT3V0cHV0c1xuICAgICAgICApXG4gICAgICB9KS50b1Rocm93KFxuICAgICAgICBcIkVycm9yIC0gSW1wb3J0VHg6IGR1cGxpY2F0ZSAoYWRkcmVzcywgYXNzZXRJZCkgcGFpciBmb3VuZCBpbiBvdXRwdXRzOiAoMHg4ZGI5N2M3Y2VjZTI0OWMyYjk4YmRjMDIyNmNjNGMyYTU3YmY1MmZjLCAyZm9tYmhMN2FHUHdqM0tINGJmcm1Kd1c2UFZuTW9iZjlZMmZuOUd3eGlBQUp5RkRiZSlcIlxuICAgICAgKVxuICAgIH0pXG5cbiAgICB0ZXN0KFwiTXVsdGlwbGUgQVZBWCBFVk1PdXRwdXQgc3VjY2Vzc1wiLCAoKTogdm9pZCA9PiB7XG4gICAgICBjb25zdCBvdXRwdXRpZHg6IEJ1ZmZlciA9IEJ1ZmZlci5mcm9tKFwiXCIpXG4gICAgICBjb25zdCBpbnB1dDogU0VDUFRyYW5zZmVySW5wdXQgPSBuZXcgU0VDUFRyYW5zZmVySW5wdXQoT05FQVZBWClcbiAgICAgIGNvbnN0IHhmZXJpbjogVHJhbnNmZXJhYmxlSW5wdXQgPSBuZXcgVHJhbnNmZXJhYmxlSW5wdXQoXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUodHhJRCksXG4gICAgICAgIG91dHB1dGlkeCxcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShhdmF4QXNzZXRJRCksXG4gICAgICAgIGlucHV0XG4gICAgICApXG4gICAgICBpbXBvcnRlZElucy5wdXNoKHhmZXJpbilcbiAgICAgIC8vIENyZWF0aW5nIDIgb3V0cHV0cyB3aXRoIGRpZmZlcmVudCBhZGRyZXNzZXMgdmFsaWRcbiAgICAgIGxldCBldm1PdXRwdXQ6IEVWTU91dHB1dCA9IG5ldyBFVk1PdXRwdXQoXG4gICAgICAgIGNIZXhBZGRyZXNzMSxcbiAgICAgICAgT05FQVZBWC5kaXYobmV3IEJOKDMpKSxcbiAgICAgICAgYXZheEFzc2V0SURcbiAgICAgIClcbiAgICAgIGV2bU91dHB1dHMucHVzaChldm1PdXRwdXQpXG4gICAgICBldm1PdXRwdXQgPSBuZXcgRVZNT3V0cHV0KFxuICAgICAgICBjSGV4QWRkcmVzczIsXG4gICAgICAgIE9ORUFWQVguZGl2KG5ldyBCTigzKSksXG4gICAgICAgIGF2YXhBc3NldElEXG4gICAgICApXG4gICAgICBldm1PdXRwdXRzLnB1c2goZXZtT3V0cHV0KVxuXG4gICAgICBjb25zdCBpbXBvcnRUeDogSW1wb3J0VHggPSBuZXcgSW1wb3J0VHgoXG4gICAgICAgIG5ldHdvcmtJRCxcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShibG9ja2NoYWluSUQpLFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHNvdXJjZWNoYWluSUQpLFxuICAgICAgICBpbXBvcnRlZElucyxcbiAgICAgICAgZXZtT3V0cHV0c1xuICAgICAgKVxuICAgICAgZXhwZWN0KGltcG9ydFR4KS50b0JlSW5zdGFuY2VPZihJbXBvcnRUeClcbiAgICB9KVxuXG4gICAgdGVzdChcIk11bHRpcGxlIEFOVCBFVk1PdXRwdXQgZmFpbFwiLCAoKTogdm9pZCA9PiB7XG4gICAgICBjb25zdCBvdXRwdXRpZHg6IEJ1ZmZlciA9IEJ1ZmZlci5mcm9tKFwiXCIpXG4gICAgICBjb25zdCBpbnB1dDogU0VDUFRyYW5zZmVySW5wdXQgPSBuZXcgU0VDUFRyYW5zZmVySW5wdXQobmV3IEJOKDUwNykpXG4gICAgICBjb25zdCB4ZmVyaW46IFRyYW5zZmVyYWJsZUlucHV0ID0gbmV3IFRyYW5zZmVyYWJsZUlucHV0KFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHR4SUQpLFxuICAgICAgICBvdXRwdXRpZHgsXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoYXZheEFzc2V0SUQpLFxuICAgICAgICBpbnB1dFxuICAgICAgKVxuICAgICAgaW1wb3J0ZWRJbnMucHVzaCh4ZmVyaW4pXG4gICAgICAvLyBDcmVhdGluZyAyIG91dHB1dHMgd2l0aCB0aGUgc2FtZSBhZGRyZXNzIGFuZCBBTlQgYXNzZXRJRCBpcyBpbnZhbGlkXG4gICAgICBsZXQgZXZtT3V0cHV0OiBFVk1PdXRwdXQgPSBuZXcgRVZNT3V0cHV0KFxuICAgICAgICBjSGV4QWRkcmVzczEsXG4gICAgICAgIE9ORUFWQVgsXG4gICAgICAgIGFudEFzc2V0SURcbiAgICAgIClcbiAgICAgIGV2bU91dHB1dHMucHVzaChldm1PdXRwdXQpXG4gICAgICBldm1PdXRwdXQgPSBuZXcgRVZNT3V0cHV0KGNIZXhBZGRyZXNzMSwgT05FQVZBWCwgYW50QXNzZXRJRClcbiAgICAgIGV2bU91dHB1dHMucHVzaChldm1PdXRwdXQpXG4gICAgICBleHBlY3QoKCk6IHZvaWQgPT4ge1xuICAgICAgICBuZXcgSW1wb3J0VHgoXG4gICAgICAgICAgbmV0d29ya0lELFxuICAgICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoYmxvY2tjaGFpbklEKSxcbiAgICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHNvdXJjZWNoYWluSUQpLFxuICAgICAgICAgIGltcG9ydGVkSW5zLFxuICAgICAgICAgIGV2bU91dHB1dHNcbiAgICAgICAgKVxuICAgICAgfSkudG9UaHJvdyhcbiAgICAgICAgXCJFcnJvciAtIEltcG9ydFR4OiBkdXBsaWNhdGUgKGFkZHJlc3MsIGFzc2V0SWQpIHBhaXIgZm91bmQgaW4gb3V0cHV0czogKDB4OGRiOTdjN2NlY2UyNDljMmI5OGJkYzAyMjZjYzRjMmE1N2JmNTJmYywgRjRNeUpjVXZxM1J4YnFnZDRaczhzVXB2d0xIQXB5cnA0eXhKWGUyYkFWODZWdnAzOClcIlxuICAgICAgKVxuICAgIH0pXG5cbiAgICB0ZXN0KFwiTXVsdGlwbGUgQU5UIEVWTU91dHB1dCBzdWNjZXNzXCIsICgpOiB2b2lkID0+IHtcbiAgICAgIGNvbnN0IG91dHB1dGlkeDogQnVmZmVyID0gQnVmZmVyLmZyb20oXCJcIilcbiAgICAgIGNvbnN0IGlucHV0OiBTRUNQVHJhbnNmZXJJbnB1dCA9IG5ldyBTRUNQVHJhbnNmZXJJbnB1dChmZWUpXG4gICAgICBjb25zdCB4ZmVyaW46IFRyYW5zZmVyYWJsZUlucHV0ID0gbmV3IFRyYW5zZmVyYWJsZUlucHV0KFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHR4SUQpLFxuICAgICAgICBvdXRwdXRpZHgsXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoYXZheEFzc2V0SUQpLFxuICAgICAgICBpbnB1dFxuICAgICAgKVxuICAgICAgaW1wb3J0ZWRJbnMucHVzaCh4ZmVyaW4pXG4gICAgICBsZXQgZXZtT3V0cHV0OiBFVk1PdXRwdXQgPSBuZXcgRVZNT3V0cHV0KFxuICAgICAgICBjSGV4QWRkcmVzczEsXG4gICAgICAgIE9ORUFWQVgsXG4gICAgICAgIGFudEFzc2V0SURcbiAgICAgIClcbiAgICAgIGV2bU91dHB1dHMucHVzaChldm1PdXRwdXQpXG4gICAgICBldm1PdXRwdXQgPSBuZXcgRVZNT3V0cHV0KGNIZXhBZGRyZXNzMiwgT05FQVZBWCwgYW50QXNzZXRJRClcbiAgICAgIGV2bU91dHB1dHMucHVzaChldm1PdXRwdXQpXG5cbiAgICAgIGNvbnN0IGltcG9ydFR4OiBJbXBvcnRUeCA9IG5ldyBJbXBvcnRUeChcbiAgICAgICAgbmV0d29ya0lELFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKGJsb2NrY2hhaW5JRCksXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoc291cmNlY2hhaW5JRCksXG4gICAgICAgIGltcG9ydGVkSW5zLFxuICAgICAgICBldm1PdXRwdXRzXG4gICAgICApXG4gICAgICBleHBlY3QoaW1wb3J0VHgpLnRvQmVJbnN0YW5jZU9mKEltcG9ydFR4KVxuICAgIH0pXG5cbiAgICB0ZXN0KFwiU2luZ2xlIEFOVCBFVk1PdXRwdXQgZmFpbFwiLCAoKTogdm9pZCA9PiB7XG4gICAgICBjb25zdCBvdXRwdXRpZHg6IEJ1ZmZlciA9IEJ1ZmZlci5mcm9tKFwiXCIpXG4gICAgICBjb25zdCBpbnB1dDogU0VDUFRyYW5zZmVySW5wdXQgPSBuZXcgU0VDUFRyYW5zZmVySW5wdXQobmV3IEJOKDApKVxuICAgICAgY29uc3QgeGZlcmluOiBUcmFuc2ZlcmFibGVJbnB1dCA9IG5ldyBUcmFuc2ZlcmFibGVJbnB1dChcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZSh0eElEKSxcbiAgICAgICAgb3V0cHV0aWR4LFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKGF2YXhBc3NldElEKSxcbiAgICAgICAgaW5wdXRcbiAgICAgIClcbiAgICAgIGltcG9ydGVkSW5zLnB1c2goeGZlcmluKVxuXG4gICAgICAvLyBJZiB0aGUgb3V0cHV0IGlzIGEgbm9uLWF2YXggYXNzZXRJRCB0aGVuIGRvbid0IHN1YnRyYWN0IGEgZmVlXG4gICAgICBjb25zdCBldm1PdXRwdXQ6IEVWTU91dHB1dCA9IG5ldyBFVk1PdXRwdXQoXG4gICAgICAgIGNIZXhBZGRyZXNzMSxcbiAgICAgICAgT05FQVZBWCxcbiAgICAgICAgYW50QXNzZXRJRFxuICAgICAgKVxuICAgICAgZXZtT3V0cHV0cy5wdXNoKGV2bU91dHB1dClcbiAgICAgIGV4cGVjdCgoKTogdm9pZCA9PiB7XG4gICAgICAgIG5ldyBJbXBvcnRUeChcbiAgICAgICAgICBuZXR3b3JrSUQsXG4gICAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShibG9ja2NoYWluSUQpLFxuICAgICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoc291cmNlY2hhaW5JRCksXG4gICAgICAgICAgaW1wb3J0ZWRJbnMsXG4gICAgICAgICAgZXZtT3V0cHV0c1xuICAgICAgICApXG4gICAgICB9KS50b1Rocm93KFxuICAgICAgICBcIkVycm9yIC0gMTAwMDAwMCBBVkFYIHJlcXVpcmVkIGZvciBmZWUgYW5kIG9ubHkgMCBBVkFYIHByb3ZpZGVkXCJcbiAgICAgIClcbiAgICB9KVxuXG4gICAgdGVzdChcIlNpbmdsZSBBTlQgRVZNT3V0cHV0IHN1Y2Nlc3NcIiwgKCk6IHZvaWQgPT4ge1xuICAgICAgY29uc3Qgb3V0cHV0aWR4OiBCdWZmZXIgPSBCdWZmZXIuZnJvbShcIlwiKVxuICAgICAgY29uc3QgaW5wdXQ6IFNFQ1BUcmFuc2ZlcklucHV0ID0gbmV3IFNFQ1BUcmFuc2ZlcklucHV0KE9ORUFWQVgpXG4gICAgICBjb25zdCB4ZmVyaW46IFRyYW5zZmVyYWJsZUlucHV0ID0gbmV3IFRyYW5zZmVyYWJsZUlucHV0KFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHR4SUQpLFxuICAgICAgICBvdXRwdXRpZHgsXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoYXZheEFzc2V0SUQpLFxuICAgICAgICBpbnB1dFxuICAgICAgKVxuICAgICAgaW1wb3J0ZWRJbnMucHVzaCh4ZmVyaW4pXG4gICAgICBjb25zdCBldm1PdXRwdXQ6IEVWTU91dHB1dCA9IG5ldyBFVk1PdXRwdXQoXG4gICAgICAgIGNIZXhBZGRyZXNzMSxcbiAgICAgICAgT05FQVZBWCxcbiAgICAgICAgYW50QXNzZXRJRFxuICAgICAgKVxuICAgICAgZXZtT3V0cHV0cy5wdXNoKGV2bU91dHB1dClcbiAgICAgIGNvbnN0IGltcG9ydFR4OiBJbXBvcnRUeCA9IG5ldyBJbXBvcnRUeChcbiAgICAgICAgbmV0d29ya0lELFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKGJsb2NrY2hhaW5JRCksXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoc291cmNlY2hhaW5JRCksXG4gICAgICAgIGltcG9ydGVkSW5zLFxuICAgICAgICBldm1PdXRwdXRzXG4gICAgICApXG4gICAgICBleHBlY3QoaW1wb3J0VHgpLnRvQmVJbnN0YW5jZU9mKEltcG9ydFR4KVxuICAgIH0pXG5cbiAgICB0ZXN0KFwiU2luZ2xlIEFWQVggRVZNT3V0cHV0IGZhaWxcIiwgKCk6IHZvaWQgPT4ge1xuICAgICAgY29uc3Qgb3V0cHV0aWR4OiBCdWZmZXIgPSBCdWZmZXIuZnJvbShcIlwiKVxuICAgICAgY29uc3QgaW5wdXQ6IFNFQ1BUcmFuc2ZlcklucHV0ID0gbmV3IFNFQ1BUcmFuc2ZlcklucHV0KG5ldyBCTig1MDcpKVxuICAgICAgY29uc3QgeGZlcmluOiBUcmFuc2ZlcmFibGVJbnB1dCA9IG5ldyBUcmFuc2ZlcmFibGVJbnB1dChcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZSh0eElEKSxcbiAgICAgICAgb3V0cHV0aWR4LFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKGF2YXhBc3NldElEKSxcbiAgICAgICAgaW5wdXRcbiAgICAgIClcbiAgICAgIGltcG9ydGVkSW5zLnB1c2goeGZlcmluKVxuXG4gICAgICBjb25zdCBldm1PdXRwdXQ6IEVWTU91dHB1dCA9IG5ldyBFVk1PdXRwdXQoXG4gICAgICAgIGNIZXhBZGRyZXNzMSxcbiAgICAgICAgbmV3IEJOKDApLFxuICAgICAgICBhdmF4QXNzZXRJRFxuICAgICAgKVxuICAgICAgZXZtT3V0cHV0cy5wdXNoKGV2bU91dHB1dClcbiAgICAgIGV4cGVjdCgoKTogdm9pZCA9PiB7XG4gICAgICAgIG5ldyBJbXBvcnRUeChcbiAgICAgICAgICBuZXR3b3JrSUQsXG4gICAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShibG9ja2NoYWluSUQpLFxuICAgICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoc291cmNlY2hhaW5JRCksXG4gICAgICAgICAgaW1wb3J0ZWRJbnMsXG4gICAgICAgICAgZXZtT3V0cHV0c1xuICAgICAgICApXG4gICAgICB9KS50b1Rocm93KFxuICAgICAgICBcIkVycm9yIC0gMTAwMDAwMCBBVkFYIHJlcXVpcmVkIGZvciBmZWUgYW5kIG9ubHkgNTA3IEFWQVggcHJvdmlkZWRcIlxuICAgICAgKVxuICAgIH0pXG5cbiAgICB0ZXN0KFwiU2luZ2xlIEFWQVggRVZNT3V0cHV0IHN1Y2Nlc3NcIiwgKCk6IHZvaWQgPT4ge1xuICAgICAgY29uc3Qgb3V0cHV0aWR4OiBCdWZmZXIgPSBCdWZmZXIuZnJvbShcIlwiKVxuICAgICAgY29uc3QgaW5wdXQ6IFNFQ1BUcmFuc2ZlcklucHV0ID0gbmV3IFNFQ1BUcmFuc2ZlcklucHV0KE9ORUFWQVgpXG4gICAgICBjb25zdCB4ZmVyaW46IFRyYW5zZmVyYWJsZUlucHV0ID0gbmV3IFRyYW5zZmVyYWJsZUlucHV0KFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHR4SUQpLFxuICAgICAgICBvdXRwdXRpZHgsXG4gICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoYXZheEFzc2V0SUQpLFxuICAgICAgICBpbnB1dFxuICAgICAgKVxuICAgICAgaW1wb3J0ZWRJbnMucHVzaCh4ZmVyaW4pXG4gICAgICBjb25zdCBldm1PdXRwdXQ6IEVWTU91dHB1dCA9IG5ldyBFVk1PdXRwdXQoXG4gICAgICAgIGNIZXhBZGRyZXNzMSxcbiAgICAgICAgT05FQVZBWC5zdWIoTUlMTElBVkFYKSxcbiAgICAgICAgYXZheEFzc2V0SURcbiAgICAgIClcbiAgICAgIGV2bU91dHB1dHMucHVzaChldm1PdXRwdXQpXG4gICAgICBjb25zdCBpbXBvcnRUeDogSW1wb3J0VHggPSBuZXcgSW1wb3J0VHgoXG4gICAgICAgIG5ldHdvcmtJRCxcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShibG9ja2NoYWluSUQpLFxuICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKHNvdXJjZWNoYWluSUQpLFxuICAgICAgICBpbXBvcnRlZElucyxcbiAgICAgICAgZXZtT3V0cHV0c1xuICAgICAgKVxuICAgICAgZXhwZWN0KGltcG9ydFR4KS50b0JlSW5zdGFuY2VPZihJbXBvcnRUeClcbiAgICB9KVxuICB9KVxufSlcbiJdfQ==